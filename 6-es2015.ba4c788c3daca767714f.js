(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{cyGc:function(e,t,s){"use strict";s.r(t);var i=s("ofXK"),c=s("kt0X");const n={selectedItem:null,list:[],recentlyViewedItems:[],recentmostItem:null};var o=s("j9Al");const l={SetSelectedItem:Object(o.a)("[SetSelectedItem]"),SetPurpose:Object(o.a)("[SetPurpose]"),UpdateOrganizationPurpose:Object(o.a)("[UpdateOrganizationPurpose]"),SetRecentlyViewed:Object(o.a)("[SetRecentlyViewed]")};class r{constructor(e){this.payload=e,this.type=l.SetSelectedItem}}class d{constructor(e){this.payload=e,this.type=l.SetPurpose}}class b{constructor(e){this.payload=e,this.type=l.UpdateOrganizationPurpose}}var a=s("krUz");function p(e,t){switch(t.type){case l.SetSelectedItem:return Object.assign(Object.assign({},e),{selectedItem:t.payload});case l.SetPurpose:return Object.assign(Object.assign({},e),{list:t.payload});case l.UpdateOrganizationPurpose:{const s=t.payload||{};return Object.assign(Object.assign({},e),{list:e.list.map(e=>e.issueType===a.a.Organization?Object.assign(Object.assign({},e),{key:s.name,title:s.name,purpose:s.purpose}):e)})}case l.SetRecentlyViewed:return Object.assign(Object.assign({},e),{recentmostItem:t.payload});default:return e}}var u=s("fXoL"),h=s("pLZG"),f=s("ze3F"),m=s("6NWb"),g=s("l2bN"),I=s("1kSV");function y(e,t){1&e&&(u.Wb(0,"div"),u.Rb(1,"fa-icon",2),u.Kc(2," There are no extended fields/attributes for this record. "),u.Vb())}const v=function(e){return{small:e}};function k(e,t){if(1&e&&(u.Wb(0,"div",5),u.Wb(1,"div",6),u.Wb(2,"div",7),u.Kc(3),u.Vb(),u.Wb(4,"div",8),u.Wb(5,"ngx-md"),u.Kc(6),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&e){const e=t.$implicit,s=u.kc(3);u.Cb(3),u.Lc(e.name),u.Cb(1),u.pc("ngClass",u.tc(3,v,s.fontSizeSmall)),u.Cb(2),u.Mc(" ",e.value," ")}}function V(e,t){if(1&e&&(u.Wb(0,"div",3),u.Ic(1,k,7,5,"div",4),u.Vb()),2&e){const e=u.kc(2);u.Cb(1),u.pc("ngForOf",e.issue.extendedFields)}}function W(e,t){if(1&e&&(u.Wb(0,"div"),u.Ic(1,y,3,0,"div",0),u.Ic(2,V,2,1,"div",1),u.Vb()),2&e){const e=u.kc();u.Cb(1),u.pc("ngIf",!e.issue.extendedFields||0===e.issue.extendedFields.length),u.Cb(1),u.pc("ngIf",e.issue.extendedFields&&e.issue.extendedFields.length>0)}}let w=(()=>{class e{constructor(){this.fontSizeSmall=!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=u.Kb({type:e,selectors:[["app-extended-fields"]],inputs:{issue:"issue"},decls:1,vars:1,consts:[[4,"ngIf"],["class","list-group list-group-flush small",4,"ngIf"],["icon","exclamation-triangle",1,"text-info"],[1,"list-group","list-group-flush","small"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[1,"row"],[1,"col-md-2","small","text-muted","text-uppercase"],[1,"col-md-10",3,"ngClass"]],template:function(e,t){1&e&&u.Ic(0,W,3,2,"div",0),2&e&&u.pc("ngIf",t.issue)},directives:[i.l,m.a,i.k,i.j,g.a],encapsulation:2}),e})();function C(e,t){if(1&e&&(u.Wb(0,"div",17),u.Wb(1,"h5",18),u.Kc(2),u.Vb(),u.Wb(3,"ngx-md"),u.Kc(4),u.Vb(),u.Vb()),2&e){const e=u.kc().$implicit;u.Cb(2),u.Mc(" ",e.title," "),u.Cb(2),u.Mc(" ",e.purpose," ")}}const F=function(e){return{"float-left":e}};function x(e,t){if(1&e&&(u.Wb(0,"div",9),u.Rb(1,"div",3),u.Wb(2,"div",14),u.Wb(3,"a",11),u.ic("click",(function(){const e=t.$implicit;return e.show=!e.show})),u.Rb(4,"fa-icon",12),u.Wb(5,"span",15),u.Kc(6),u.Vb(),u.Vb(),u.Vb(),u.Ic(7,C,5,2,"div",16),u.Vb()),2&e){const e=t.$implicit;u.pc("ngClass",u.tc(4,F,!e.show)),u.Cb(4),u.pc("icon",e.show?"chevron-down":"chevron-right"),u.Cb(2),u.Mc("",e.issueType," purpose"),u.Cb(1),u.pc("ngIf",e.show)}}const j=function(e){return{small:e}};function O(e,t){if(1&e){const e=u.Xb();u.Wb(0,"div",9),u.Wb(1,"div",10),u.Wb(2,"a",11),u.ic("click",(function(){u.Bc(e);const t=u.kc();return t.showHideAllPurposes(!t.showAll)})),u.Rb(3,"fa-icon",12),u.Vb(),u.Vb(),u.Ic(4,x,8,6,"div",13),u.Vb()}if(2&e){const e=u.kc();u.pc("ngClass",u.tc(3,j,e.fontSizeSmall)),u.Cb(3),u.pc("icon",e.showAll?"angle-double-down":"angle-double-right"),u.Cb(1),u.pc("ngForOf",e.purpose)}}function S(e,t){if(1&e){const e=u.Xb();u.Wb(0,"div",19),u.Wb(1,"button",20),u.ic("click",(function(){u.Bc(e);const t=u.kc();return t.hideExtendedFields=!t.hideExtendedFields})),u.Rb(2,"fa-icon",21),u.Wb(3,"span",15),u.Kc(4,"DETAILS"),u.Vb(),u.Vb(),u.Wb(5,"div",22),u.Rb(6,"app-extended-fields",23),u.Vb(),u.Vb()}if(2&e){const e=u.kc();u.Cb(2),u.pc("icon",e.hideExtendedFields?"chevron-right":"chevron-down"),u.Cb(3),u.pc("ngbCollapse",e.hideExtendedFields),u.Cb(1),u.pc("issue",e.selectedItem)}}let $=(()=>{class e{constructor(e,t){this.persistenceService=e,this.store$=t,this.edit=new u.n,this.showAll=!1,this.hideExtendedFields=!1,this.fontSizeSmall=!1}ngOnInit(){this.selectedItem$=this.store$.select(e=>e.purpose.selectedItem).pipe(Object(h.a)(e=>e)).subscribe(e=>this.selectedItem=e),this.purpose$=this.store$.select(e=>e.purpose.list).pipe(Object(h.a)(e=>e)).subscribe(e=>{this.purpose=e})}ngOnDestroy(){this.purpose$&&this.purpose$.unsubscribe(),this.hierarchySetupVisibility$&&this.hierarchySetupVisibility$.unsubscribe(),this.selectedItem$&&this.selectedItem$.unsubscribe()}showHideAllPurposes(e){this.showAll=e,this.purpose&&(this.purpose.forEach(e=>e.show=this.showAll),!this.showAll&&this.purpose.length>0&&(this.purpose[this.purpose.length-1].show=!0))}}return e.\u0275fac=function(t){return new(t||e)(u.Qb(f.a),u.Qb(c.h))},e.\u0275cmp=u.Kb({type:e,selectors:[["app-purpose"]],outputs:{edit:"edit"},decls:12,vars:4,consts:[[1,"row"],[1,"col-md-10"],[3,"ngClass",4,"ngIf"],[1,"clearfix"],["class","ml-4 mr-5",4,"ngIf"],[1,"col-md-2"],[1,"sticky-title","text-right"],[1,"btn","btn-light","btn-sm","mr-2",3,"disabled","click"],[1,"btn","btn-light",3,"disabled","click"],[3,"ngClass"],[1,"border-0","pb-0","mb-2","float-left"],["title","Show/hide details",1,"btn","btn-light","btn-sm","text-muted","mr-2",3,"click"],["size","fw",3,"icon"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"text-uppercase","text-muted"],[1,"small"],["class","ml-3 pl-3 pr-3 border-left","style","overflow:auto",4,"ngIf"],[1,"ml-3","pl-3","pr-3","border-left",2,"overflow","auto"],[1,"text-dark","font-weight-normal","mt-1"],[1,"ml-4","mr-5"],[1,"btn","btn-sm","btn-light","text-muted",3,"click"],["size","sm",3,"icon"],[1,"ml-3","border-left",3,"ngbCollapse"],[3,"issue"]],template:function(e,t){1&e&&(u.Wb(0,"div",0),u.Wb(1,"div",1),u.Ic(2,O,5,5,"div",2),u.Wb(3,"div",3),u.Kc(4,"\xa0"),u.Vb(),u.Ic(5,S,7,3,"div",4),u.Vb(),u.Wb(6,"div",5),u.Wb(7,"div",6),u.Wb(8,"button",7),u.ic("click",(function(){return t.fontSizeSmall=!0})),u.Kc(9,"A"),u.Vb(),u.Wb(10,"button",8),u.ic("click",(function(){return t.fontSizeSmall=!1})),u.Kc(11,"A"),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&e&&(u.Cb(2),u.pc("ngIf",t.purpose&&t.purpose.length>0),u.Cb(3),u.pc("ngIf",t.selectedItem&&t.selectedItem.extendedFields&&t.selectedItem.extendedFields.length>0),u.Cb(3),u.pc("disabled",t.fontSizeSmall),u.Cb(2),u.pc("disabled",!t.fontSizeSmall))},directives:[i.l,i.j,m.a,i.k,g.a,I.b,w],encapsulation:2}),e})();var K=s("tyNb"),T=s("e/fS"),L=s("3Pt+"),E=s("jLSX"),z=s("LvDl"),M=s("itXk"),A=s("F2Ol");function R(e,t){if(1&e){const e=u.Xb();u.Wb(0,"th",9),u.Wb(1,"a",10),u.ic("click",(function(){return u.Bc(e),u.kc(3).showHideExtendedFields()})),u.Rb(2,"fa-icon",11),u.Vb(),u.Vb()}if(2&e){const e=u.kc(3);u.Cb(2),u.pc("icon",e.hideExtendedFields?"angle-double-right":"angle-double-down")}}function P(e,t){if(1&e&&(u.Wb(0,"span",12),u.Kc(1),u.Vb()),2&e){const e=u.kc(3);u.Cb(1),u.Mc(" ",e.filteredItems.length," ")}}function D(e,t){if(1&e&&(u.Wb(0,"option",16),u.Kc(1),u.Vb()),2&e){const e=t.$implicit;u.pc("value",e.key),u.Cb(1),u.Mc(" ",e.key+" ("+e.count+")","")}}function Q(e,t){if(1&e){const e=u.Xb();u.Wb(0,"select",13),u.ic("ngModelChange",(function(t){return u.Bc(e),u.kc(3).issueTypeFilter=t}))("change",(function(){return u.Bc(e),u.kc(3).onFilterChanged()})),u.Wb(1,"option",14),u.Kc(2,"All"),u.Vb(),u.Ic(3,D,2,2,"option",15),u.Vb()}if(2&e){const e=u.kc(3);u.pc("ngModel",e.issueTypeFilter),u.Cb(3),u.pc("ngForOf",e.issueTypeStats)}}function B(e,t){if(1&e&&(u.Wb(0,"option",16),u.Kc(1),u.Vb()),2&e){const e=t.$implicit;u.pc("value",e.key),u.Cb(1),u.Mc(" ",e.key+" ("+e.count+")","")}}function X(e,t){if(1&e){const e=u.Xb();u.Wb(0,"select",13),u.ic("ngModelChange",(function(t){return u.Bc(e),u.kc(3).statusFilter=t}))("change",(function(){return u.Bc(e),u.kc(3).onFilterChanged()})),u.Wb(1,"option",14),u.Kc(2,"All"),u.Vb(),u.Ic(3,B,2,2,"option",15),u.Vb()}if(2&e){const e=u.kc(3);u.pc("ngModel",e.statusFilter),u.Cb(3),u.pc("ngForOf",e.statusStats)}}function N(e,t){if(1&e){const e=u.Xb();u.Wb(0,"td"),u.Wb(1,"a",10),u.ic("click",(function(){u.Bc(e);const t=u.kc().$implicit;return t.hideExtendedFields=!t.hideExtendedFields})),u.Rb(2,"fa-icon",11),u.Vb(),u.Vb()}if(2&e){const e=u.kc().$implicit;u.Cb(2),u.pc("icon",e.hideExtendedFields?"angle-right":"angle-down")}}function U(e,t){if(1&e&&(u.Wb(0,"tr"),u.Wb(1,"td",24),u.Kc(2),u.Vb(),u.Wb(3,"td",25),u.Kc(4),u.Vb(),u.Vb()),2&e){const e=t.$implicit;u.Cb(2),u.Mc("",e.name,":"),u.Cb(2),u.Mc(" ",e.value," ")}}function H(e,t){if(1&e&&(u.Wb(0,"div",22),u.Wb(1,"table",23),u.Ic(2,U,5,2,"tr",8),u.Vb(),u.Vb()),2&e){const e=u.kc().$implicit;u.Cb(2),u.pc("ngForOf",e.extendedFields)}}function J(e,t){if(1&e&&(u.Wb(0,"tr"),u.Ic(1,N,3,1,"td",0),u.Wb(2,"td",17),u.Kc(3),u.Vb(),u.Wb(4,"td"),u.Wb(5,"div"),u.Kc(6),u.Vb(),u.Ic(7,H,3,1,"div",18),u.Vb(),u.Wb(8,"td",19),u.Wb(9,"small",20),u.Kc(10),u.Vb(),u.Vb(),u.Wb(11,"td",19),u.Wb(12,"span",21),u.Kc(13),u.Vb(),u.Vb(),u.Vb()),2&e){const e=t.$implicit,s=u.kc(3);u.Cb(1),u.pc("ngIf",s.hasExtendedFields),u.Cb(2),u.Mc(" ",e.key," "),u.Cb(3),u.Lc(e.title),u.Cb(1),u.pc("ngIf",!e.hideExtendedFields&&e.extendedFields&&e.extendedFields.length>0),u.Cb(3),u.Lc(e.issueType),u.Cb(3),u.Lc(e.status)}}function G(e,t){if(1&e&&(u.Wb(0,"div"),u.Wb(1,"table",2),u.Wb(2,"thead"),u.Wb(3,"tr"),u.Ic(4,R,3,1,"th",3),u.Wb(5,"th",4),u.Ic(6,P,2,1,"span",5),u.Kc(7),u.Vb(),u.Wb(8,"th",6),u.Ic(9,Q,4,2,"select",7),u.Vb(),u.Wb(10,"th",6),u.Ic(11,X,4,2,"select",7),u.Vb(),u.Vb(),u.Vb(),u.Ic(12,J,14,6,"tr",8),u.Vb(),u.Vb()),2&e){const e=u.kc(2);u.Cb(4),u.pc("ngIf",e.hasExtendedFields),u.Cb(2),u.pc("ngIf",e.filteredItems.length>0),u.Cb(1),u.Mc(" record",e.filteredItems.length>1?"s":""," "),u.Cb(2),u.pc("ngIf",e.issueTypeStats&&e.issueTypeStats.length>1),u.Cb(2),u.pc("ngIf",e.statusStats&&e.statusStats.length>1),u.Cb(1),u.pc("ngForOf",e.filteredItems)}}function q(e,t){1&e&&(u.Wb(0,"div",26),u.Kc(1," No detail records found. "),u.Vb())}function Z(e,t){if(1&e&&(u.Wb(0,"div"),u.Ic(1,G,13,6,"div",0),u.Ic(2,q,2,0,"div",1),u.Vb()),2&e){const e=u.kc();u.Cb(1),u.pc("ngIf",e.filteredItems&&e.filteredItems.length>0),u.Cb(1),u.pc("ngIf",e.filteredItems&&0===e.filteredItems.length)}}let Y=(()=>{class e{constructor(e,t,s){this.jiraService=e,this.persistenceService=t,this.store$=s,this.childIssueType="",this.hasExtendedFields=!1,this.showDetails=!1,this.hideExtendedFields=!0,this.statusFilter="all",this.issueTypeFilter="all"}ngOnInit(){const e=this.store$.select(e=>e.purpose.selectedItem).pipe(Object(h.a)(e=>e)),t=this.store$.select(e=>e.app.projects);this.issueSubscription=Object(M.a)(e,t).subscribe(([e,t])=>{this.issue=e,this.issue.project=z.find(t,{key:this.issue.project.key}),this.loadDetails(this.issue)})}ngOnDestroy(){this.issueSubscription&&this.issueSubscription.unsubscribe(),this.projectsSubscription&&this.projectsSubscription.unsubscribe()}loadDetails(e){if(e.project&&e.project.subTaskIssueTypes&&e.project.subTaskIssueTypes.length>0){const t=z.join(z.map(e.project.subTaskIssueTypes,e=>`'${e.name}'`),","),s=z.spread(z.union)(z.map(e.project.subTaskIssueTypes,"list"));this.hasExtendedFields=s&&s.length>0;const i=z.map(s,"id");this.jiraService.executeJql(`issuetype in (${t}) AND parent=${e.key}`,0,100,i,"test-cases.json").pipe(Object(h.a)(e=>e&&e.issues)).subscribe(e=>{this.childItems=Object(a.g)(e.issues),this.childItems.forEach(e=>e.hideExtendedFields=!0),Object(a.c)(this.childItems,s),this.onFilterChanged();const t=z.mapValues(z.groupBy(z.map(this.childItems,"status")),e=>e.length);this.statusStats=Object.keys(t).map(e=>({key:e,count:t[e]}));const i=z.mapValues(z.groupBy(z.map(this.childItems,"issueType")),e=>e.length);this.issueTypeStats=Object.keys(i).map(e=>({key:e,count:i[e]}))})}}onFilterChanged(){this.filteredItems=z.filter(this.childItems,e=>!(this.statusFilter&&"all"!==this.statusFilter&&e.status!==this.statusFilter||this.issueTypeFilter&&"all"!==this.issueTypeFilter&&e.issueType!==this.issueTypeFilter)),this.filteredItems=z.orderBy(this.filteredItems,["issueType","status"])}showHideExtendedFields(){this.hideExtendedFields=!this.hideExtendedFields,this.childItems&&this.childItems.forEach(e=>e.hideExtendedFields=this.hideExtendedFields)}}return e.\u0275fac=function(t){return new(t||e)(u.Qb(A.b),u.Qb(f.a),u.Qb(c.h))},e.\u0275cmp=u.Kb({type:e,selectors:[["app-task-list"]],decls:1,vars:1,consts:[[4,"ngIf"],["class","alert alert-warning",4,"ngIf"],[1,"table"],["width","1%",4,"ngIf"],["colspan","2",1,"text-muted"],["class","mr-1",4,"ngIf"],["width","10%"],["class","form-control form-control-sm bg-light border-0",3,"ngModel","ngModelChange","change",4,"ngIf"],[4,"ngFor","ngForOf"],["width","1%"],["title","Show/hide details",1,"text-muted",3,"click"],["size","sm",3,"icon"],[1,"mr-1"],[1,"form-control","form-control-sm","bg-light","border-0",3,"ngModel","ngModelChange","change"],["value","all"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["width","5%",1,"text-muted","font-weight-light",2,"white-space","nowrap"],["style","overflow: auto;","class","alert mt-2 p-0 rounded-0 border-0",4,"ngIf"],[2,"white-space","nowrap"],[1,"text-muted"],[1,"pl-1","pr-1","border","rounded","bg-light","small"],[1,"alert","mt-2","p-0","rounded-0","border-0",2,"overflow","auto"],[1,"table","table-small","small","p-0","m-0","border-0","bg-light","extended-fields"],["width","10%",1,"p-1","text-nowrap","text-muted"],["Markdown","",1,"p-1","text-dark"],[1,"alert","alert-warning"]],template:function(e,t){1&e&&u.Ic(0,Z,3,2,"div",0),2&e&&u.pc("ngIf",t.issue)},directives:[i.l,i.k,m.a,L.i,L.f,L.g,L.h,L.j,g.a],encapsulation:2}),e})();var _=s("lJxs"),ee=s("LvOF");function te(e,t){if(1&e&&(u.Wb(0,"span",19),u.Kc(1),u.Vb()),2&e){const e=t.$implicit;u.Cb(1),u.Lc(e)}}function se(e,t){if(1&e&&(u.Wb(0,"div",16),u.Wb(1,"span",17),u.Kc(2,"FIX VERSION: "),u.Vb(),u.Ic(3,te,2,1,"span",18),u.Vb()),2&e){const e=u.kc(2);u.Cb(3),u.pc("ngForOf",e.selectedItem.fixVersions)}}function ie(e,t){if(1&e&&(u.Wb(0,"span",22),u.Kc(1),u.Vb()),2&e){const e=t.$implicit;u.Cb(1),u.Lc(e)}}function ce(e,t){if(1&e&&(u.Wb(0,"div",20),u.Ic(1,ie,2,1,"span",21),u.Vb()),2&e){const e=u.kc(2);u.Cb(1),u.pc("ngForOf",e.selectedItem.labels)}}function ne(e,t){1&e&&(u.Wb(0,"a",23),u.Rb(1,"fa-icon",24),u.Kc(2," Task breakup "),u.Vb()),2&e&&u.pc("routerLinkActive","active")}const oe=function(e){return["../../storyboard",e,"details"]},le=function(e){return["../../storyboard",e,"list"]},re=function(){return["far","copy"]};function de(e,t){if(1&e&&(u.Wb(0,"div",25),u.Wb(1,"a",26),u.Rb(2,"fa-icon",27),u.Kc(3," Storyboard "),u.Vb(),u.Wb(4,"div",28),u.Rb(5,"button",29),u.Wb(6,"div",30),u.Wb(7,"a",31),u.Rb(8,"fa-icon",13),u.Kc(9," Story list "),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&e){const e=u.kc(2);u.Cb(1),u.pc("routerLink",u.tc(5,oe,e.selectedItem.key))("routerLinkActive","active"),u.Cb(6),u.pc("routerLink",u.tc(7,le,e.selectedItem.key))("routerLinkActive","active"),u.Cb(1),u.pc("icon",u.sc(9,re))}}const be=function(){return["details"]},ae=function(){return["far","lightbulb"]};function pe(e,t){if(1&e&&(u.Wb(0,"div",2),u.Wb(1,"div",3),u.Wb(2,"div"),u.Ic(3,se,4,1,"div",4),u.Wb(4,"sub",5),u.Kc(5),u.Vb(),u.Wb(6,"sub",6),u.Kc(7),u.Vb(),u.Vb(),u.Wb(8,"h2",7),u.Kc(9),u.Vb(),u.Ic(10,ce,2,1,"div",8),u.Wb(11,"div",9),u.Wb(12,"div",10),u.Wb(13,"div",11),u.Wb(14,"a",12),u.Rb(15,"fa-icon",13),u.Kc(16," Purpose "),u.Vb(),u.Ic(17,ne,3,1,"a",14),u.Ic(18,de,10,10,"div",15),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&e){const e=u.kc();u.Cb(3),u.pc("ngIf",e.selectedItem.fixVersions&&e.selectedItem.fixVersions.length>0),u.Cb(2),u.Nc("",e.selectedItem.issueType,": ",e.selectedItem.key,""),u.Cb(2),u.Mc(" ",e.selectedItem.status," "),u.Cb(2),u.Mc(" ",e.selectedItem.title," "),u.Cb(1),u.pc("ngIf",e.selectedItem.labels&&e.selectedItem.labels.length>0),u.Cb(4),u.pc("routerLink",u.sc(11,be))("routerLinkActive","active"),u.Cb(1),u.pc("icon",u.sc(12,ae)),u.Cb(2),u.pc("ngIf","Epic"!==e.selectedItem.issueType),u.Cb(1),u.pc("ngIf",e.canNavigateToStoryboard())}}let ue=(()=>{class e{constructor(e,t,s,i){this.activatedRoute=e,this.persistenceService=t,this.jiraService=s,this.store$=i,this.currentIssueKey=""}ngOnInit(){this.localNodeType=a.a,this.organization$=this.store$.select(e=>e.app.organization).pipe(Object(h.a)(e=>e)).subscribe(e=>this.store$.dispatch(new b(e))),this.currentIssueKey$=this.store$.select(e=>e.app.currentIssueKey).pipe(Object(h.a)(e=>e&&e.length>0)).subscribe(e=>this.currentIssueKey=e),this.selectedItem$=this.store$.select(e=>e.purpose.selectedItem).pipe(Object(h.a)(e=>e)).subscribe(e=>this.selectedItem=e),this.issueQuery$=this.store$.select(e=>e.app.hierarchicalIssue).pipe(Object(h.a)(e=>e)),this.paramsQuery$=this.activatedRoute.params.pipe(Object(h.a)(e=>e&&e.selected&&e.selected.length>0),Object(_.a)(e=>e.selected)),this.projectsQuery$=this.store$.select(e=>e.app.projects).pipe(Object(h.a)(e=>e)),this.combined$=Object(M.a)(this.issueQuery$,this.paramsQuery$,this.projectsQuery$).subscribe(([e,t,s])=>{this.projects=s;const i=Object(a.n)(e,a.a.Project),c=Object(a.o)(e,t);if(i&&c){c.extendedFields=Object(ee.a)(this.projects,i.key,c.issueType);const e=z.map(c.extendedFields,"id");this.jiraService.getIssueDetails(t,e).pipe(Object(h.a)(e=>null!=e&&e.fields)).subscribe(e=>{Object(a.e)(Object(a.l)(e),c),c.extendedFields=z.map(c.extendedFields,t=>(t.value=e.fields[t.id],t));const t=z.pick(c,["key","label","title","issueType","project","status","description","components","labels","fixVersions","extendedFields","children"]);this.store$.dispatch(new r(t))})}setTimeout(()=>this.markIssueSelected(c),500)})}ngOnDestroy(){this.organization$&&this.organization$.unsubscribe(),this.combined$&&this.combined$.unsubscribe(),this.selectedItem$&&this.selectedItem$.unsubscribe(),this.currentIssueKey$&&this.currentIssueKey$.unsubscribe()}markIssueSelected(e){if(e)if(this.projects&&e.project&&(e.extendedFields=Object(ee.a)(this.projects,e.project.key,e.issueType)),!e.parent||e.parent.issueType!==a.a.RelatedLink||e.description&&0!==e.description.length)this.expandPurpose(e);else{const t=z.map(e.extendedFields,"id");this.jiraService.getIssueDetails(e.key,t).pipe(Object(h.a)(e=>null!=e)).subscribe(t=>{const s=Object(a.l)(t);s&&Object(a.e)(s,e),e.extendedFields=z.map(e.extendedFields,e=>(e.value=t.fields[e.id],e)),this.expandPurpose(e)})}}expandPurpose(e){this.purpose=[],this.populatePurpose(e),z.reverse(this.purpose),this.purpose.length>0&&(this.purpose[this.purpose.length-1].show=!0),this.store$.dispatch(new d(this.purpose))}populatePurpose(e){e&&(e.issueType!==a.a.EpicChildren&&e.issueType!==a.a.RelatedLink&&this.purpose.push({key:e.key,issueType:e.issueType,title:e.title,purpose:e.description,editable:e.editable,hfKey:e.hfKey,show:!1}),e.parent&&this.populatePurpose(e.parent))}canNavigateToStoryboard(){return this.selectedItem&&("Epic"===this.selectedItem.issueType||this.currentIssueKey.toLowerCase()===this.selectedItem.key.toLowerCase())}}return e.\u0275fac=function(t){return new(t||e)(u.Qb(K.a),u.Qb(f.a),u.Qb(A.b),u.Qb(c.h))},e.\u0275cmp=u.Kb({type:e,selectors:[["app-container"]],decls:4,vars:1,consts:[[1,"pt-0","pr-3","pb-2","pl-3"],["class","sticky-title pb-3",4,"ngIf"],[1,"sticky-title","pb-3"],[1,"border-bottom"],["class","float-right small",4,"ngIf"],[1,"text-uppercase","mr-2"],[1,"badge","badge-light","small","text-muted","text-uppercase","font-weight-normal"],[1,"font-weight-light","mb-0"],["class","small",4,"ngIf"],[1,"pb-2"],[1,"row"],[1,"col-md-8"],["title","View purpose",1,"btn","btn-link","mr-1","pl-0",3,"routerLink","routerLinkActive"],["size","sm",3,"icon"],["class","btn btn-link mr-1","routerLink","items",3,"routerLinkActive",4,"ngIf"],["class","btn-group mr-1",4,"ngIf"],[1,"float-right","small"],[1,"small","text-muted"],["class","badge badge-light ml-1",4,"ngFor","ngForOf"],[1,"badge","badge-light","ml-1"],[1,"small"],["class","mr-1 pl-1 pr-1 bg-light text-muted rounded",4,"ngFor","ngForOf"],[1,"mr-1","pl-1","pr-1","bg-light","text-muted","rounded"],["routerLink","items",1,"btn","btn-link","mr-1",3,"routerLinkActive"],["icon","list-ol","size","sm"],[1,"btn-group","mr-1"],[1,"btn","btn-link","pr-0",3,"routerLink","routerLinkActive"],["icon","map","size","sm"],["ngbDropdown","","display","dynamic","placement","bottom-right"],["id","dropdownBasic1","ngbDropdownToggle","","title","story list",1,"btn","btn-link"],["ngbDropdownMenu","","aria-labelledby","dropdownBasic1",1,"dropdown-menu-right"],["ngbDropdownItem","",3,"routerLink","routerLinkActive"]],template:function(e,t){1&e&&(u.Wb(0,"div",0),u.Ic(1,pe,19,13,"div",1),u.Wb(2,"div"),u.Rb(3,"router-outlet"),u.Vb(),u.Vb()),2&e&&(u.Cb(1),u.pc("ngIf",t.selectedItem))},directives:[i.l,K.h,K.f,K.e,m.a,i.k,I.d,I.h,I.f,I.e],encapsulation:2}),e})();s.d(t,"PurposeModule",(function(){return fe}));const he=[{path:":selected",component:ue,children:[{path:"items",component:Y},{path:"attributes",component:w},{path:"details",component:$},{path:"",redirectTo:"details",pathMatch:"full"}]}];let fe=(()=>{class e{}return e.\u0275mod=u.Ob({type:e}),e.\u0275inj=u.Nb({factory:function(t){return new(t||e)},imports:[[i.c,K.g,L.c,g.b,m.c,E.b,I.g,I.c,T.a,c.i.forFeature("purpose",p,{initialState:n}),K.g.forChild(he)]]}),e})()}}]);