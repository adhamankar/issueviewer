function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var i=[],n=!0,s=!1,r=void 0;try{for(var c,o=e[Symbol.iterator]();!(n=(c=o.next()).done)&&(i.push(c.value),!t||i.length!==t);n=!0);}catch(a){s=!0,r=a}finally{try{n||null==o.return||o.return()}finally{if(s)throw r}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{cyGc:function(e,t,i){"use strict";i.r(t);var n=i("ofXK"),s=i("kt0X"),r={selectedItem:null,item:null,recentlyViewedItems:[],recentmostItem:null,organizationEditorVisible:!1,hierarchyEditorVisible:!1},c=i("Kv0p");function o(e,t){switch(t.type){case c.a.SetSelectedItem:return Object.assign(Object.assign({},e),{selectedItem:t.payload});case c.a.SetPurpose:return Object.assign(Object.assign({},e),{item:t.payload});case c.a.SetRecentlyViewed:return Object.assign(Object.assign({},e),{recentmostItem:t.payload});case c.a.ManageOrganizationEditorVisibility:return Object.assign(Object.assign({},e),{organizationEditorVisible:t.payload});case c.a.ManageHierarchyEditorVisibility:return Object.assign(Object.assign({},e),{hierarchyEditorVisible:t.payload});default:return e}}var a=i("fXoL"),l=i("LvDl"),u=i("pLZG"),b=i("krUz"),d=i("ze3F"),p=i("jLSX"),h=i("F2Ol"),f=i("vjJ9"),g=i("3Pt+");function v(e,t){if(1&e){var i=a.Xb();a.Wb(0,"div",6),a.Wb(1,"div",7),a.Wb(2,"label",8),a.Kc(3,"Organization name"),a.Vb(),a.Wb(4,"input",9),a.ic("ngModelChange",(function(e){return a.Bc(i),a.kc().organization.name=e}))("keydown.control.enter",(function(){return a.Bc(i),a.kc().onSave()})),a.Vb(),a.Vb(),a.Wb(5,"div",7),a.Wb(6,"label",8),a.Kc(7,"Purpose"),a.Vb(),a.Wb(8,"textarea",10),a.ic("ngModelChange",(function(e){return a.Bc(i),a.kc().organization.purpose=e}))("keydown.control.enter",(function(){return a.Bc(i),a.kc().onSave()})),a.Vb(),a.Vb(),a.Vb()}if(2&e){var n=a.kc();a.Cb(4),a.pc("ngModel",n.organization.name),a.Cb(4),a.pc("ngModel",n.organization.purpose)}}var m,y=((m=function(){function e(t,i){_classCallCheck(this,e),this.jiraService=t,this.persistenceService=i,this.close=new a.n}return _createClass(e,[{key:"ngOnInit",value:function(){this.organization=this.persistenceService.getOrganizationDetails()||{}}},{key:"onSave",value:function(){this.persistenceService.setOrganizationDetails(this.organization),this.onClose(!0)}},{key:"onClose",value:function(e){this.close.emit(e)}},{key:"onReset",value:function(){this.persistenceService.resetOrganizationDetails(),this.onClose(!0)}}]),e}()).\u0275fac=function(e){return new(e||m)(a.Qb(h.b),a.Qb(d.a))},m.\u0275cmp=a.Kb({type:m,selectors:[["app-organization"]],outputs:{close:"close"},decls:8,vars:1,consts:[[1,"pane"],[1,"pane-header"],[1,"pane-body","p-3"],["class","container",4,"ngIf"],[1,"pane-footer"],[3,"save","close","reset"],[1,"container"],[1,"form-group"],["for","name"],["type","text","id","name","name","name","placeholder","organization name",1,"form-control","form-control-lg",3,"ngModel","ngModelChange","keydown.control.enter"],["rows","5",1,"form-control",3,"ngModel","ngModelChange","keydown.control.enter"]],template:function(e,t){1&e&&(a.Wb(0,"div",0),a.Wb(1,"div",1),a.Wb(2,"h4"),a.Kc(3,"Organization setup"),a.Vb(),a.Vb(),a.Wb(4,"div",2),a.Ic(5,v,9,2,"div",3),a.Vb(),a.Wb(6,"div",4),a.Wb(7,"app-button-panel",5),a.ic("save",(function(){return t.onSave()}))("close",(function(){return t.onClose(!1)}))("reset",(function(){return t.onReset()})),a.Vb(),a.Vb(),a.Vb()),2&e&&(a.Cb(5),a.pc("ngIf",t.organization))},directives:[n.l,f.a,g.a,g.e,g.f],encapsulation:2}),m);function k(e,t){if(1&e){var i=a.Xb();a.Wb(0,"div",3),a.Wb(1,"h4",4),a.Kc(2),a.Vb(),a.Wb(3,"div",5),a.Rb(4,"h5",4),a.Wb(5,"div",6),a.Wb(6,"label",7),a.Kc(7,"Purpose"),a.Vb(),a.Wb(8,"textarea",8),a.ic("ngModelChange",(function(e){return a.Bc(i),a.kc().hierarchyField.purpose=e}))("keydown.control.enter",(function(){return a.Bc(i),a.kc().onSave()})),a.Vb(),a.Vb(),a.Vb(),a.Rb(9,"hr"),a.Wb(10,"app-button-panel",9),a.ic("save",(function(){return a.Bc(i),a.kc().onSave()}))("close",(function(){return a.Bc(i),a.kc().onClose(!1)}))("reset",(function(){return a.Bc(i),a.kc().onReset()})),a.Vb(),a.Vb()}if(2&e){var n=a.kc();a.Cb(2),a.Lc(n.hierarchyField.title),a.Cb(6),a.pc("ngModel",n.hierarchyField.purpose)}}var I,V=((I=function(){function e(t,i){_classCallCheck(this,e),this.jiraService=t,this.persistenceService=i,this.close=new a.n}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"onSave",value:function(){this.persistenceService.setHierarchyFieldDetails(this.hierarchyField),this.onClose(!0)}},{key:"onClose",value:function(e){this.close.emit(e)}},{key:"onReset",value:function(){this.persistenceService.resetHierarchyFields(),this.onClose(!0)}}]),e}()).\u0275fac=function(e){return new(e||I)(a.Qb(h.b),a.Qb(d.a))},I.\u0275cmp=a.Kb({type:I,selectors:[["app-hierarchy-field"]],inputs:{hierarchyField:"hierarchyField"},outputs:{close:"close"},decls:3,vars:1,consts:[[1,"pane"],[1,"pane-body","p-3"],["class","container",4,"ngIf"],[1,"container"],[1,"mb-2"],[1,"alert","bg-light","mb-3"],[1,"form-group"],["for","name"],["rows","5",1,"form-control",3,"ngModel","ngModelChange","keydown.control.enter"],[3,"save","close","reset"]],template:function(e,t){1&e&&(a.Wb(0,"div",0),a.Wb(1,"div",1),a.Ic(2,k,11,2,"div",2),a.Vb(),a.Vb()),2&e&&(a.Cb(2),a.pc("ngIf",t.hierarchyField))},directives:[n.l,g.a,g.e,g.f,f.a],encapsulation:2}),I),C=i("6NWb"),W=i("l2bN");function w(e,t){if(1&e){var i=a.Xb();a.Wb(0,"div",19),a.Wb(1,"div",20),a.Wb(2,"div",21),a.Kc(3,"Setup organization purpose here"),a.Vb(),a.Wb(4,"button",22),a.ic("click",(function(){return a.Bc(i),a.kc(3).showOrganizationSetup=!0})),a.Rb(5,"fa-icon",23),a.Kc(6," add organization purpose "),a.Vb(),a.Vb(),a.Vb()}}var S=function(e){return{"float-left":e}};function F(e,t){if(1&e){var i=a.Xb();a.Wb(0,"div",10),a.Rb(1,"div",15),a.Wb(2,"div",16),a.Wb(3,"a",12),a.ic("click",(function(){a.Bc(i);var e=a.kc(2);return e.showOrgPurposeEditor=!e.showOrgPurposeEditor})),a.Rb(4,"fa-icon",13),a.Wb(5,"span",17),a.Kc(6,"Organization purpose"),a.Vb(),a.Vb(),a.Vb(),a.Ic(7,w,7,0,"div",18),a.Vb()}if(2&e){var n=a.kc(2);a.pc("ngClass",a.tc(3,S,!n.showOrgPurposeEditor)),a.Cb(4),a.pc("icon",n.showOrgPurposeEditor?"chevron-down":"chevron-right"),a.Cb(3),a.pc("ngIf",n.showOrgPurposeEditor)}}function O(e,t){if(1&e){var i=a.Xb();a.Wb(0,"a",28),a.ic("click",(function(){a.Bc(i);var e=a.kc(2).$implicit;return a.kc(2).onEdit(e)})),a.Rb(1,"fa-icon",29),a.Vb()}}var x=function(e){return{readonly:e}};function j(e,t){if(1&e&&(a.Wb(0,"div",25),a.Wb(1,"h5",26),a.Kc(2),a.Ic(3,O,2,0,"a",27),a.Vb(),a.Wb(4,"ngx-md"),a.Kc(5),a.Vb(),a.Vb()),2&e){var i=a.kc().$implicit;a.pc("ngClass",a.tc(4,x,!i.editable)),a.Cb(2),a.Mc("",i.title," "),a.Cb(1),a.pc("ngIf",i.editable),a.Cb(2),a.Mc(" ",i.purpose," ")}}function z(e,t){if(1&e&&(a.Wb(0,"div",10),a.Rb(1,"div",15),a.Wb(2,"div",16),a.Wb(3,"a",12),a.ic("click",(function(){var e=t.$implicit;return e.show=!e.show})),a.Rb(4,"fa-icon",13),a.Wb(5,"span",17),a.Kc(6),a.Vb(),a.Vb(),a.Vb(),a.Ic(7,j,6,6,"div",24),a.Vb()),2&e){var i=t.$implicit;a.pc("ngClass",a.tc(4,S,!i.show)),a.Cb(4),a.pc("icon",i.show?"chevron-down":"chevron-right"),a.Cb(2),a.Mc("",i.issueType," purpose"),a.Cb(1),a.pc("ngIf",i.show)}}var $=function(e){return{small:e}};function K(e,t){if(1&e){var i=a.Xb();a.Wb(0,"div",10),a.Wb(1,"div",11),a.Wb(2,"a",12),a.ic("click",(function(){a.Bc(i);var e=a.kc();return e.showHideAllPurposes(!e.showAll)})),a.Rb(3,"fa-icon",13),a.Vb(),a.Vb(),a.Ic(4,F,8,5,"div",2),a.Ic(5,z,8,6,"div",14),a.Vb()}if(2&e){var n=a.kc();a.pc("ngClass",a.tc(4,$,n.fontSizeSmall)),a.Cb(3),a.pc("icon",n.showAll?"angle-double-down":"angle-double-right"),a.Cb(1),a.pc("ngIf",!n.organizationPurpose),a.Cb(1),a.pc("ngForOf",n.purpose)}}var T,E=((T=function(){function e(t,i){_classCallCheck(this,e),this.persistenceService=t,this.store$=i,this.edit=new a.n,this.showAll=!1,this.showOrganizationSetup=!1,this.showOrgPurposeEditor=!1,this.showHierarchyFieldSetup=!1,this.fontSizeSmall=!1,this.organizationPurpose=this.persistenceService.getOrganizationDetails()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.purpose$=this.store$.select((function(e){return e.purpose.item})).pipe(Object(u.a)((function(e){return e}))).subscribe((function(t){e.purpose=t,e.showHideAllPurposes(!1)})),this.orgSetupVisibility$=this.store$.select((function(e){return e.purpose.organizationEditorVisible})).subscribe((function(t){return e.showOrganizationSetup=t})),this.hierarchySetupVisibility$=this.store$.select((function(e){return e.purpose.hierarchyEditorVisible})).subscribe((function(t){return e.showHierarchyFieldSetup=t}))}},{key:"ngOnDestroy",value:function(){this.purpose$&&this.purpose$.unsubscribe(),this.orgSetupVisibility$&&this.orgSetupVisibility$.unsubscribe(),this.hierarchySetupVisibility$&&this.hierarchySetupVisibility$.unsubscribe()}},{key:"onEdit",value:function(e){e.issueType===b.a.Organization?this.showOrganizationSetup=!0:!0===e.editable&&(this.hierarchyFieldPurpose=l.clone(e),this.showHierarchyFieldSetup=!0),this.edit.emit(e)}},{key:"setupOrganization",value:function(){this.showOrganizationSetup=!0}},{key:"setupCompleted",value:function(e){e?window.location.reload():(this.showOrganizationSetup=!1,this.showHierarchyFieldSetup=!1,this.store$.dispatch(new c.c(!1)),this.store$.dispatch(new c.b(!1)))}},{key:"showHideAllPurposes",value:function(e){var t=this;this.showAll=e,this.purpose&&(this.purpose.forEach((function(e){return e.show=t.showAll})),!this.showAll&&this.purpose.length>0&&(this.purpose[this.purpose.length-1].show=!0))}}]),e}()).\u0275fac=function(e){return new(e||T)(a.Qb(d.a),a.Qb(s.h))},T.\u0275cmp=a.Kb({type:T,selectors:[["app-purpose"]],outputs:{edit:"edit"},decls:13,vars:6,consts:[[1,"row"],[1,"col-md-10"],[3,"ngClass",4,"ngIf"],[1,"col-md-2"],[1,"sticky-title","text-right"],[1,"btn","btn-light","btn-sm","mr-2",3,"disabled","click"],[1,"btn","btn-light",3,"disabled","click"],["styleClass","ui-sidebar-md","position","right",3,"visible","visibleChange"],[3,"close"],[3,"hierarchyField","close"],[3,"ngClass"],[1,"border-0","pb-0","mb-2","float-left"],["title","Show/hide details",1,"btn","btn-light","btn-sm","text-muted","mr-2",3,"click"],["size","fw",3,"icon"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"clearfix"],[1,"text-uppercase","text-muted"],[1,"small"],["class","ml-3 p-3 border-left","style","overflow:auto",4,"ngIf"],[1,"ml-3","p-3","border-left",2,"overflow","auto"],[1,"alert","bg-light"],[1,"mb-2"],[1,"btn","btn-outline-primary","btn-sm",3,"click"],["icon","plus",1,"font-weight-light"],["class","ml-3 hover-container pl-3 pr-3 border-left","style","overflow:auto",3,"ngClass",4,"ngIf"],[1,"ml-3","hover-container","pl-3","pr-3","border-left",2,"overflow","auto",3,"ngClass"],[1,"text-dark","font-weight-normal","mt-1"],["class","small text-muted ml-2 hover-button",3,"click",4,"ngIf"],[1,"small","text-muted","ml-2","hover-button",3,"click"],["icon","pencil-alt","size","sm"]],template:function(e,t){1&e&&(a.Wb(0,"div",0),a.Wb(1,"div",1),a.Ic(2,K,6,6,"div",2),a.Vb(),a.Wb(3,"div",3),a.Wb(4,"div",4),a.Wb(5,"button",5),a.ic("click",(function(){return t.fontSizeSmall=!0})),a.Kc(6,"A"),a.Vb(),a.Wb(7,"button",6),a.ic("click",(function(){return t.fontSizeSmall=!1})),a.Kc(8,"A"),a.Vb(),a.Vb(),a.Vb(),a.Vb(),a.Wb(9,"p-sidebar",7),a.ic("visibleChange",(function(e){return t.showOrganizationSetup=e})),a.Wb(10,"app-organization",8),a.ic("close",(function(e){return t.setupCompleted(e)})),a.Vb(),a.Vb(),a.Wb(11,"p-sidebar",7),a.ic("visibleChange",(function(e){return t.showHierarchyFieldSetup=e})),a.Wb(12,"app-hierarchy-field",9),a.ic("close",(function(e){return t.setupCompleted(e)})),a.Vb(),a.Vb()),2&e&&(a.Cb(2),a.pc("ngIf",t.purpose&&t.purpose.length>0),a.Cb(3),a.pc("disabled",t.fontSizeSmall),a.Cb(2),a.pc("disabled",!t.fontSizeSmall),a.Cb(2),a.pc("visible",t.showOrganizationSetup),a.Cb(2),a.pc("visible",t.showHierarchyFieldSetup),a.Cb(1),a.pc("hierarchyField",t.hierarchyFieldPurpose))},directives:[n.l,p.a,y,V,n.j,C.a,n.k,W.a],encapsulation:2}),T),M=i("tyNb"),L=i("e/fS"),A=i("itXk");function P(e,t){if(1&e){var i=a.Xb();a.Wb(0,"th",9),a.Wb(1,"a",10),a.ic("click",(function(){return a.Bc(i),a.kc(3).showHideExtendedFields()})),a.Rb(2,"fa-icon",11),a.Vb(),a.Vb()}if(2&e){var n=a.kc(3);a.Cb(2),a.pc("icon",n.hideExtendedFields?"angle-double-right":"angle-double-down")}}function R(e,t){if(1&e&&(a.Wb(0,"span",12),a.Kc(1),a.Vb()),2&e){var i=a.kc(3);a.Cb(1),a.Mc(" ",i.filteredItems.length," ")}}function _(e,t){if(1&e&&(a.Wb(0,"option",16),a.Kc(1),a.Vb()),2&e){var i=t.$implicit;a.pc("value",i.key),a.Cb(1),a.Mc(" ",i.key+" ("+i.count+")","")}}function B(e,t){if(1&e){var i=a.Xb();a.Wb(0,"select",13),a.ic("ngModelChange",(function(e){return a.Bc(i),a.kc(3).issueTypeFilter=e}))("change",(function(){return a.Bc(i),a.kc(3).onFilterChanged()})),a.Wb(1,"option",14),a.Kc(2,"All"),a.Vb(),a.Ic(3,_,2,2,"option",15),a.Vb()}if(2&e){var n=a.kc(3);a.pc("ngModel",n.issueTypeFilter),a.Cb(3),a.pc("ngForOf",n.issueTypeStats)}}function Q(e,t){if(1&e&&(a.Wb(0,"option",16),a.Kc(1),a.Vb()),2&e){var i=t.$implicit;a.pc("value",i.key),a.Cb(1),a.Mc(" ",i.key+" ("+i.count+")","")}}function D(e,t){if(1&e){var i=a.Xb();a.Wb(0,"select",13),a.ic("ngModelChange",(function(e){return a.Bc(i),a.kc(3).statusFilter=e}))("change",(function(){return a.Bc(i),a.kc(3).onFilterChanged()})),a.Wb(1,"option",14),a.Kc(2,"All"),a.Vb(),a.Ic(3,Q,2,2,"option",15),a.Vb()}if(2&e){var n=a.kc(3);a.pc("ngModel",n.statusFilter),a.Cb(3),a.pc("ngForOf",n.statusStats)}}function H(e,t){if(1&e){var i=a.Xb();a.Wb(0,"td"),a.Wb(1,"a",10),a.ic("click",(function(){a.Bc(i);var e=a.kc().$implicit;return e.hideExtendedFields=!e.hideExtendedFields})),a.Rb(2,"fa-icon",11),a.Vb(),a.Vb()}if(2&e){var n=a.kc().$implicit;a.Cb(2),a.pc("icon",n.hideExtendedFields?"angle-right":"angle-down")}}function X(e,t){if(1&e&&(a.Wb(0,"tr"),a.Wb(1,"td",24),a.Kc(2),a.Vb(),a.Wb(3,"td",25),a.Kc(4),a.Vb(),a.Vb()),2&e){var i=t.$implicit;a.Cb(2),a.Mc("",i.name,":"),a.Cb(2),a.Lc(i.value)}}function N(e,t){if(1&e&&(a.Wb(0,"div",22),a.Wb(1,"table",23),a.Ic(2,X,5,2,"tr",8),a.Vb(),a.Vb()),2&e){var i=a.kc().$implicit;a.Cb(2),a.pc("ngForOf",i.extendedFields)}}function J(e,t){if(1&e&&(a.Wb(0,"tr"),a.Ic(1,H,3,1,"td",0),a.Wb(2,"td",17),a.Kc(3),a.Vb(),a.Wb(4,"td"),a.Wb(5,"div"),a.Kc(6),a.Vb(),a.Ic(7,N,3,1,"div",18),a.Vb(),a.Wb(8,"td",19),a.Wb(9,"small",20),a.Kc(10),a.Vb(),a.Vb(),a.Wb(11,"td",19),a.Wb(12,"span",21),a.Kc(13),a.Vb(),a.Vb(),a.Vb()),2&e){var i=t.$implicit,n=a.kc(3);a.Cb(1),a.pc("ngIf",n.hasExtendedFields),a.Cb(2),a.Mc(" ",i.key," "),a.Cb(3),a.Lc(i.title),a.Cb(1),a.pc("ngIf",!i.hideExtendedFields&&i.extendedFields&&i.extendedFields.length>0),a.Cb(3),a.Lc(i.issueType),a.Cb(3),a.Lc(i.status)}}function G(e,t){if(1&e&&(a.Wb(0,"div"),a.Wb(1,"table",2),a.Wb(2,"thead"),a.Wb(3,"tr"),a.Ic(4,P,3,1,"th",3),a.Wb(5,"th",4),a.Ic(6,R,2,1,"span",5),a.Kc(7),a.Vb(),a.Wb(8,"th",6),a.Ic(9,B,4,2,"select",7),a.Vb(),a.Wb(10,"th",6),a.Ic(11,D,4,2,"select",7),a.Vb(),a.Vb(),a.Vb(),a.Ic(12,J,14,6,"tr",8),a.Vb(),a.Vb()),2&e){var i=a.kc(2);a.Cb(4),a.pc("ngIf",i.hasExtendedFields),a.Cb(2),a.pc("ngIf",i.filteredItems.length>0),a.Cb(1),a.Mc(" record",i.filteredItems.length>1?"s":""," "),a.Cb(2),a.pc("ngIf",i.issueTypeStats&&i.issueTypeStats.length>1),a.Cb(2),a.pc("ngIf",i.statusStats&&i.statusStats.length>1),a.Cb(1),a.pc("ngForOf",i.filteredItems)}}function q(e,t){1&e&&(a.Wb(0,"div",26),a.Kc(1," No detail records found. "),a.Vb())}function U(e,t){if(1&e&&(a.Wb(0,"div"),a.Ic(1,G,13,6,"div",0),a.Ic(2,q,2,0,"div",1),a.Vb()),2&e){var i=a.kc();a.Cb(1),a.pc("ngIf",i.filteredItems&&i.filteredItems.length>0),a.Cb(1),a.pc("ngIf",i.filteredItems&&0===i.filteredItems.length)}}var Z,Y=((Z=function(){function e(t,i,n){_classCallCheck(this,e),this.jiraService=t,this.persistenceService=i,this.store$=n,this.childIssueType="",this.hasExtendedFields=!1,this.showDetails=!1,this.hideExtendedFields=!0,this.statusFilter="all",this.issueTypeFilter="all"}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this,t=this.store$.select((function(e){return e.purpose.selectedItem})).pipe(Object(u.a)((function(e){return e}))),i=this.store$.select((function(e){return e.app.projects}));this.issueSubscription=Object(A.a)(t,i).subscribe((function(t){var i=_slicedToArray(t,2),n=i[0],s=i[1];e.issue=n,e.issue.project=l.find(s,{key:e.issue.project.key}),e.loadDetails(e.issue)}))}},{key:"ngOnDestroy",value:function(){this.issueSubscription&&this.issueSubscription.unsubscribe(),this.projectsSubscription&&this.projectsSubscription.unsubscribe()}},{key:"loadDetails",value:function(e){var t=this;if(e.project&&e.project.subTaskIssueTypes&&e.project.subTaskIssueTypes.length>0){var i=l.join(l.map(e.project.subTaskIssueTypes,(function(e){return"'".concat(e.name,"'")})),","),n=l.spread(l.union)(l.map(e.project.subTaskIssueTypes,"list"));this.hasExtendedFields=n&&n.length>0;var s=l.map(n,"id");this.jiraService.executeJql("issuetype in (".concat(i,") AND parent=").concat(e.key),0,100,s,"test-cases.json").pipe(Object(u.a)((function(e){return e&&e.issues}))).subscribe((function(e){t.childItems=Object(b.f)(e.issues),t.childItems.forEach((function(e){return e.hideExtendedFields=!0})),Object(b.b)(t.childItems,n),t.onFilterChanged();var i=l.mapValues(l.groupBy(l.map(t.childItems,"status")),(function(e){return e.length}));t.statusStats=Object.keys(i).map((function(e){return{key:e,count:i[e]}}));var s=l.mapValues(l.groupBy(l.map(t.childItems,"issueType")),(function(e){return e.length}));t.issueTypeStats=Object.keys(s).map((function(e){return{key:e,count:s[e]}}))}))}}},{key:"onFilterChanged",value:function(){var e=this;this.filteredItems=l.filter(this.childItems,(function(t){return!(e.statusFilter&&"all"!==e.statusFilter&&t.status!==e.statusFilter||e.issueTypeFilter&&"all"!==e.issueTypeFilter&&t.issueType!==e.issueTypeFilter)})),this.filteredItems=l.orderBy(this.filteredItems,"issueType")}},{key:"showHideExtendedFields",value:function(){var e=this;this.hideExtendedFields=!this.hideExtendedFields,this.childItems&&this.childItems.forEach((function(t){return t.hideExtendedFields=e.hideExtendedFields}))}}]),e}()).\u0275fac=function(e){return new(e||Z)(a.Qb(h.b),a.Qb(d.a),a.Qb(s.h))},Z.\u0275cmp=a.Kb({type:Z,selectors:[["app-sub-items"]],decls:1,vars:1,consts:[[4,"ngIf"],["class","alert alert-warning",4,"ngIf"],[1,"table"],["width","1%",4,"ngIf"],["colspan","2",1,"text-muted"],["class","mr-1",4,"ngIf"],["width","10%"],["class","form-control form-control-sm bg-light border-0",3,"ngModel","ngModelChange","change",4,"ngIf"],[4,"ngFor","ngForOf"],["width","1%"],["title","Show/hide details",1,"text-muted",3,"click"],["size","sm",3,"icon"],[1,"mr-1"],[1,"form-control","form-control-sm","bg-light","border-0",3,"ngModel","ngModelChange","change"],["value","all"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["width","5%",1,"text-muted","font-weight-light",2,"white-space","nowrap"],["style","overflow: auto;","class","alert mt-2 p-0 rounded-0 border-0",4,"ngIf"],[2,"white-space","nowrap"],[1,"text-muted"],[1,"pl-1","pr-1","border","rounded","bg-light","small"],[1,"alert","mt-2","p-0","rounded-0","border-0",2,"overflow","auto"],[1,"table","table-small","small","p-0","m-0","border-0","bg-light"],["width","10%",1,"p-1","text-nowrap","text-muted"],[1,"p-1","text-dark"],[1,"alert","alert-warning"]],template:function(e,t){1&e&&a.Ic(0,U,3,2,"div",0),2&e&&a.pc("ngIf",t.issue)},directives:[n.l,n.k,C.a,g.h,g.e,g.f,g.g,g.i],encapsulation:2}),Z);function ee(e,t){1&e&&(a.Wb(0,"div"),a.Rb(1,"fa-icon",7),a.Kc(2," There are no extended fields. "),a.Vb())}var te=function(e){return{small:e}};function ie(e,t){if(1&e&&(a.Wb(0,"div",10),a.Wb(1,"div",0),a.Wb(2,"div",11),a.Kc(3),a.Vb(),a.Wb(4,"div",12),a.Wb(5,"ngx-md"),a.Kc(6),a.Vb(),a.Vb(),a.Vb(),a.Vb()),2&e){var i=t.$implicit,n=a.kc(3);a.Cb(3),a.Lc(i.name),a.Cb(1),a.pc("ngClass",a.tc(3,te,n.fontSizeSmall)),a.Cb(2),a.Mc(" ",i.value," ")}}function ne(e,t){if(1&e&&(a.Wb(0,"div",8),a.Ic(1,ie,7,5,"div",9),a.Vb()),2&e){var i=a.kc(2);a.Cb(1),a.pc("ngForOf",i.issue.extendedFields)}}function se(e,t){if(1&e&&(a.Wb(0,"div"),a.Ic(1,ee,3,0,"div",2),a.Ic(2,ne,2,1,"div",6),a.Vb()),2&e){var i=a.kc();a.Cb(1),a.pc("ngIf",!i.issue.extendedFields||0===i.issue.extendedFields.length),a.Cb(1),a.pc("ngIf",i.issue.extendedFields&&i.issue.extendedFields.length>0)}}var re,ce=((re=function(){function e(t){_classCallCheck(this,e),this.store$=t,this.fontSizeSmall=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.issue$=this.store$.select((function(e){return e.purpose.selectedItem})).pipe(Object(u.a)((function(e){return e}))).subscribe((function(t){return e.issue=t}))}},{key:"ngOnDestroy",value:function(){this.issue$&&this.issue$.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||re)(a.Qb(s.h))},re.\u0275cmp=a.Kb({type:re,selectors:[["app-extended-fields"]],decls:8,vars:3,consts:[[1,"row"],[1,"col-md-10"],[4,"ngIf"],[1,"col-md-2","text-right"],[1,"btn","btn-light","btn-sm","mr-2",3,"disabled","click"],[1,"btn","btn-light",3,"disabled","click"],["class","list-group list-group-flush",4,"ngIf"],["icon","exclamation-triangle",1,"text-info"],[1,"list-group","list-group-flush"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[1,"col-md-2","small","text-muted","text-uppercase"],[1,"col-md-10",3,"ngClass"]],template:function(e,t){1&e&&(a.Wb(0,"div",0),a.Wb(1,"div",1),a.Ic(2,se,3,2,"div",2),a.Vb(),a.Wb(3,"div",3),a.Wb(4,"button",4),a.ic("click",(function(){return t.fontSizeSmall=!0})),a.Kc(5,"A"),a.Vb(),a.Wb(6,"button",5),a.ic("click",(function(){return t.fontSizeSmall=!1})),a.Kc(7,"A"),a.Vb(),a.Vb(),a.Vb()),2&e&&(a.Cb(2),a.pc("ngIf",t.issue),a.Cb(2),a.pc("disabled",t.fontSizeSmall),a.Cb(2),a.pc("disabled",!t.fontSizeSmall))},directives:[n.l,C.a,n.k,n.j,W.a],encapsulation:2}),re),oe=i("lJxs"),ae=i("LvOF");function le(e,t){if(1&e&&(a.Wb(0,"span",21),a.Kc(1),a.Vb()),2&e){var i=t.$implicit;a.Cb(1),a.Lc(i)}}function ue(e,t){if(1&e&&(a.Wb(0,"div",18),a.Wb(1,"span",19),a.Kc(2,"FIX VERSION: "),a.Vb(),a.Ic(3,le,2,1,"span",20),a.Vb()),2&e){var i=a.kc(2);a.Cb(3),a.pc("ngForOf",i.selectedItem.fixVersions)}}function be(e,t){if(1&e&&(a.Wb(0,"span",24),a.Kc(1),a.Vb()),2&e){var i=t.$implicit;a.Cb(1),a.Lc(i)}}function de(e,t){if(1&e&&(a.Wb(0,"div",22),a.Ic(1,be,2,1,"span",23),a.Vb()),2&e){var i=a.kc(2);a.Cb(1),a.pc("ngForOf",i.selectedItem.labels)}}var pe=function(){return["far","list-alt"]};function he(e,t){1&e&&(a.Wb(0,"a",25),a.Rb(1,"fa-icon",13),a.Kc(2," Details "),a.Vb()),2&e&&(a.pc("routerLinkActive","active"),a.Cb(1),a.pc("icon",a.sc(2,pe)))}var fe=function(e){return["../../storyboard",e]};function ge(e,t){if(1&e&&(a.Wb(0,"div",26),a.Wb(1,"a",27),a.Rb(2,"fa-icon",28),a.Kc(3," Storyboard "),a.Rb(4,"fa-icon",29),a.Vb(),a.Vb()),2&e){var i=a.kc(2);a.Cb(1),a.pc("routerLink",a.tc(2,fe,i.selectedItem.key))("routerLinkActive","active")}}var ve=function(){return["purpose"]},me=function(){return["far","lightbulb"]};function ye(e,t){if(1&e&&(a.Wb(0,"div",2),a.Wb(1,"div",3),a.Wb(2,"div"),a.Ic(3,ue,4,1,"div",4),a.Wb(4,"sub",5),a.Kc(5),a.Vb(),a.Wb(6,"sub",6),a.Kc(7),a.Vb(),a.Vb(),a.Wb(8,"h2",7),a.Kc(9),a.Vb(),a.Ic(10,de,2,1,"div",8),a.Wb(11,"div",9),a.Wb(12,"div",10),a.Wb(13,"div",11),a.Wb(14,"a",12),a.Rb(15,"fa-icon",13),a.Kc(16," Purpose "),a.Vb(),a.Ic(17,he,3,3,"a",14),a.Wb(18,"a",15),a.Rb(19,"fa-icon",16),a.Kc(20," Sub items "),a.Vb(),a.Vb(),a.Ic(21,ge,5,4,"div",17),a.Vb(),a.Vb(),a.Vb(),a.Vb()),2&e){var i=a.kc();a.Cb(3),a.pc("ngIf",i.selectedItem.fixVersions&&i.selectedItem.fixVersions.length>0),a.Cb(2),a.Nc("",i.selectedItem.issueType,": ",i.selectedItem.key,""),a.Cb(2),a.Lc(i.selectedItem.status),a.Cb(2),a.Mc(" ",i.selectedItem.title," "),a.Cb(1),a.pc("ngIf",i.selectedItem.labels&&i.selectedItem.labels.length>0),a.Cb(4),a.pc("routerLink",a.sc(12,ve))("routerLinkActive","active"),a.Cb(1),a.pc("icon",a.sc(13,me)),a.Cb(2),a.pc("ngIf",i.selectedItem.extendedFields&&i.selectedItem.extendedFields.length>0),a.Cb(1),a.pc("routerLinkActive","active"),a.Cb(3),a.pc("ngIf","Epic"===i.selectedItem.issueType)}}var ke,Ie=((ke=function(){function e(t,i,n,s){_classCallCheck(this,e),this.activatedRoute=t,this.persistenceService=i,this.jiraService=n,this.store$=s}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.localNodeType=b.a,this.selectedItem$=this.store$.select((function(e){return e.purpose.selectedItem})).pipe(Object(u.a)((function(e){return e}))).subscribe((function(t){return e.selectedItem=t})),this.issueQuery$=this.store$.select((function(e){return e.app.hierarchicalIssue})).pipe(Object(u.a)((function(e){return e}))),this.paramsQuery$=this.activatedRoute.params.pipe(Object(u.a)((function(e){return e&&e.selected&&e.selected.length>0})),Object(oe.a)((function(e){return e.selected}))),this.projectsQuery$=this.store$.select((function(e){return e.app.projects})).pipe(Object(u.a)((function(e){return e}))),this.combined$=Object(A.a)(this.issueQuery$,this.paramsQuery$,this.projectsQuery$).subscribe((function(t){var i=_slicedToArray(t,3),n=i[0],s=i[1],r=i[2];e.projects=r;var o=Object(b.l)(n,b.a.Project),a=Object(b.m)(n,s);if(o&&a){a.extendedFields=Object(ae.a)(e.projects,o.key,a.issueType);var d=l.map(a.extendedFields,"id");e.jiraService.getIssueDetails(s,d).pipe(Object(u.a)((function(e){return null!=e&&e.fields}))).subscribe((function(t){Object(b.d)(Object(b.j)(t),a),a.extendedFields=l.map(a.extendedFields,(function(e){return e.value=t.fields[e.id],e}));var i=l.pick(a,["key","label","title","issueType","project","status","description","components","labels","fixVersions","extendedFields"]);e.store$.dispatch(new c.e(i))}))}setTimeout((function(){return e.markIssueSelected(a)}),500)}))}},{key:"ngOnDestroy",value:function(){this.combined$&&this.combined$.unsubscribe(),this.selectedItem$&&this.selectedItem$.unsubscribe()}},{key:"markIssueSelected",value:function(e){var t=this;if(e)if(this.projects&&e.project&&(e.extendedFields=Object(ae.a)(this.projects,e.project.key,e.issueType)),!e.parent||e.parent.issueType!==b.a.RelatedLink||e.description&&0!==e.description.length)this.expandPurpose(e);else{var i=l.map(e.extendedFields,"id");this.jiraService.getIssueDetails(e.key,i).pipe(Object(u.a)((function(e){return null!=e}))).subscribe((function(i){var n=Object(b.j)(i);n&&Object(b.d)(n,e),e.extendedFields=l.map(e.extendedFields,(function(e){return e.value=i.fields[e.id],e})),t.expandPurpose(e)}))}}},{key:"expandPurpose",value:function(e){this.purpose=[],this.populatePurpose(e),l.reverse(this.purpose),this.store$.dispatch(new c.d(this.purpose))}},{key:"populatePurpose",value:function(e){e&&(e.issueType!==b.a.EpicChildren&&e.issueType!==b.a.RelatedLink&&this.purpose.push({key:e.key,issueType:e.issueType,title:e.title,purpose:e.description,editable:e.editable,hfKey:e.hfKey}),e.parent&&this.populatePurpose(e.parent))}}]),e}()).\u0275fac=function(e){return new(e||ke)(a.Qb(M.a),a.Qb(d.a),a.Qb(h.b),a.Qb(s.h))},ke.\u0275cmp=a.Kb({type:ke,selectors:[["app-container"]],decls:4,vars:1,consts:[[1,"pt-0","pr-3","pb-2","pl-3"],["class","sticky-title pb-3",4,"ngIf"],[1,"sticky-title","pb-3"],[1,"border-bottom"],["class","float-right small",4,"ngIf"],[1,"text-uppercase","mr-2"],[1,"badge","badge-light","small","text-muted","text-uppercase","font-weight-normal"],[1,"font-weight-light"],["class","small",4,"ngIf"],[1,"pb-2"],[1,"row"],[1,"col-md-8"],["title","View purpose",1,"btn","btn-link","mr-1","pl-0",3,"routerLink","routerLinkActive"],["size","sm",3,"icon"],["class","btn btn-link mr-1","routerLink","details",3,"routerLinkActive",4,"ngIf"],["routerLink","items",1,"btn","btn-link","mr-1",3,"routerLinkActive"],["icon","list-ol","size","sm"],["class","col-md-4 text-right",4,"ngIf"],[1,"float-right","small"],[1,"small","text-muted"],["class","badge badge-light ml-1",4,"ngFor","ngForOf"],[1,"badge","badge-light","ml-1"],[1,"small"],["class","mr-1 pl-1 pr-1 bg-light text-muted rounded",4,"ngFor","ngForOf"],[1,"mr-1","pl-1","pr-1","bg-light","text-muted","rounded"],["routerLink","details",1,"btn","btn-link","mr-1",3,"routerLinkActive"],[1,"col-md-4","text-right"],[1,"btn","btn-link","mr-1",3,"routerLink","routerLinkActive"],["icon","map","size","sm"],["icon","chevron-right","size","sm"]],template:function(e,t){1&e&&(a.Wb(0,"div",0),a.Ic(1,ye,22,14,"div",1),a.Wb(2,"div"),a.Rb(3,"router-outlet"),a.Vb(),a.Vb()),2&e&&(a.Cb(1),a.pc("ngIf",t.selectedItem))},directives:[n.l,M.h,M.f,M.e,C.a,n.k],encapsulation:2}),ke);i.d(t,"PurposeModule",(function(){return We}));var Ve,Ce=[{path:":selected",component:Ie,children:[{path:"items",component:Y},{path:"details",component:ce},{path:"purpose",component:E},{path:"",redirectTo:"purpose",pathMatch:"full"}]}],We=((Ve=function e(){_classCallCheck(this,e)}).\u0275mod=a.Ob({type:Ve}),Ve.\u0275inj=a.Nb({factory:function(e){return new(e||Ve)},imports:[[n.c,M.g,g.b,W.b,C.c,p.b,L.a,s.i.forFeature("purpose",o,{initialState:r}),M.g.forChild(Ce)]]}),Ve)}}]);