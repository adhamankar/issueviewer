<div class="main-container">
    <div class="body-container">
        <as-split direction="horizontal">
            <as-split-area size="40" class="left-split-area bg-light border-right">
                <button class="btn btn-primary btn-sm m-3" *ngIf="!organizationDetails" (click)="setupOrganization()">
                    <fa-icon icon="plus"></fa-icon> Add organization
                </button>
                <div *ngIf="linkedRecords">
                    <p-tree [value]="linkedRecords" (onNodeExpand)="loadNode($event)" [(selection)]="selectedNode"
                        (onNodeSelect)="nodeSelected($event)" selectionMode="single">
                        <ng-template let-node pTemplate="Epic">
                            <app-node-template [node]="node" icon="book" badge="badge-primary"></app-node-template>
                        </ng-template>
                        <ng-template let-node pTemplate="Organization">
                            <h3 class="m-0 font-weight-light">{{node.label}}</h3>
                        </ng-template>
                        <ng-template let-node pTemplate="Project">
                            <h4 class="m-0 font-weight-light">{{node.label}}</h4>
                        </ng-template>
                        <ng-template let-node pTemplate="Story">
                            <app-node-template [node]="node" icon="file-alt" badge="badge-info"></app-node-template>
                        </ng-template>
                        <ng-template let-node pTemplate="Test Suite">
                            <app-node-template [node]="node" icon="flask" badge="badge-warning"></app-node-template>
                        </ng-template>
                        <ng-template let-node pTemplate="ST-Test Case">
                            <app-node-template [node]="node" icon="bookmark" badge="badge-success"></app-node-template>
                        </ng-template>
                        <ng-template let-node pTemplate="Task">
                            <app-node-template [node]="node" icon="check" badge="badge-success"></app-node-template>
                        </ng-template>
                    </p-tree>
                </div>
            </as-split-area>
            <as-split-area size="60">
                <div class="main-split-area p-3">

                    <div class="list-group list-group-flush" *ngIf="purpose && purpose.length > 0">
                        <div class="list-group-item" *ngFor="let item of purpose">
                            <div style="overflow:auto">
                                <div class="badge badge-secondary">{{item.type}} purpose</div>
                                <h5 class="font-weight-light mb-1">{{item.title}}</h5>
                                <div>{{item.purpose}}</div>
                            </div>
                        </div>
                    </div>

                    <!-- <disqus [identifier]="pageId"></disqus> -->

                    <router-outlet></router-outlet>
                </div>
            </as-split-area>
        </as-split>
    </div>
</div>

<p-sidebar [(visible)]="showOrganizationSetup" styleClass="ui-sidebar-md" position="right">
    <app-organization (close)="organizationSetupCompleted()"></app-organization>
</p-sidebar>

<p-sidebar [(visible)]="showDetails" styleClass="ui-sidebar-md" position="right">
    <app-sub-details [issue]="selectedIssue"></app-sub-details>
</p-sidebar>