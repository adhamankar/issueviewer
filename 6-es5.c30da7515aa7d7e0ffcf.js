function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var i=[],s=!0,n=!1,c=void 0;try{for(var r,a=e[Symbol.iterator]();!(s=(r=a.next()).done)&&(i.push(r.value),!t||i.length!==t);s=!0);}catch(l){n=!0,c=l}finally{try{s||null==a.return||a.return()}finally{if(n)throw c}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"2Jat":function(e,t,i){"use strict";i.r(t);var s=i("ofXK"),n=i("kt0X"),c={selectedItem:null,list:[],recentlyViewedItems:[],recentmostItem:null,updatedField:null},r=i("LvDl"),a=i("j9Al"),l={SetSelectedItem:Object(a.a)("[SetSelectedItem]"),SetPurpose:Object(a.a)("[SetPurpose]"),UpdateOrganizationPurpose:Object(a.a)("[UpdateOrganizationPurpose]"),SetRecentlyViewed:Object(a.a)("[SetRecentlyViewed]"),UpdateFieldValue:Object(a.a)("[UpdateFieldValue]"),UpdateFieldValueFailed:Object(a.a)("[UpdateFieldValue] Failed"),UpdateFieldValueSuccess:Object(a.a)("[UpdateFieldValue] Success")},o=function e(t){_classCallCheck(this,e),this.payload=t,this.type=l.SetSelectedItem},u=function e(t){_classCallCheck(this,e),this.payload=t,this.type=l.SetPurpose},d=function e(t){_classCallCheck(this,e),this.payload=t,this.type=l.UpdateOrganizationPurpose},b=function e(t){_classCallCheck(this,e),this.payload=t,this.type=l.UpdateFieldValue},p=i("krUz");function h(e,t){switch(t.type){case l.SetSelectedItem:return Object.assign(Object.assign({},e),{selectedItem:t.payload});case l.SetPurpose:return Object.assign(Object.assign({},e),{list:t.payload});case l.UpdateOrganizationPurpose:var i=t.payload||{};return Object.assign(Object.assign({},e),{list:e.list.map((function(e){return e.issueType===p.a.Organization?Object.assign(Object.assign({},e),{key:i.name,title:i.name,purpose:i.purpose}):e}))});case l.SetRecentlyViewed:return Object.assign(Object.assign({},e),{recentmostItem:t.payload});case l.UpdateFieldValue:return Object.assign(Object.assign({},e),{updatedField:null});case l.UpdateFieldValueSuccess:var s=e.selectedItem,n=t.payload,c=Object(p.q)(s,n.issueKey);return c&&("title"===n.fieldName?c.title=n.updatedValue:"fixVersions"===n.fieldName&&(c.fixVersions=r.map(n.updatedValue,(function(e){return e.name})))),Object.assign(Object.assign({},e),{updatedField:n,selectedItem:s});default:return e}}var f=i("fXoL"),g=i("pLZG"),m=i("yVuU"),v=i("6NWb"),I=i("tyNb"),k=i("l2bN");function y(e,t){if(1&e&&(f.Wb(0,"div",18),f.Wb(1,"h5",19),f.Kc(2),f.Vb(),f.Rb(3,"ngx-md",20),f.Vb()),2&e){var i=f.kc().$implicit;f.Cb(2),f.Mc(" ",i.title," "),f.Cb(1),f.pc("data",i.purpose)}}var C=function(e){return{"float-left":e}};function V(e,t){if(1&e&&(f.Wb(0,"div",7),f.Rb(1,"div",12),f.Wb(2,"div",15),f.Wb(3,"a",9),f.ic("click",(function(){var e=t.$implicit;return e.show=!e.show})),f.Rb(4,"fa-icon",10),f.Wb(5,"span",16),f.Kc(6),f.Vb(),f.Vb(),f.Vb(),f.Ic(7,y,4,2,"div",17),f.Vb()),2&e){var i=t.$implicit;f.pc("ngClass",f.tc(4,C,!i.show)),f.Cb(4),f.pc("icon",i.show?"chevron-down":"chevron-right"),f.Cb(2),f.Mc("",i.issueType," purpose"),f.Cb(1),f.pc("ngIf",i.show)}}var W=function(e){return{small:e}};function j(e,t){if(1&e){var i=f.Xb();f.Wb(0,"div",7),f.Wb(1,"div",8),f.Wb(2,"a",9),f.ic("click",(function(){f.Bc(i);var e=f.kc();return e.showHideAllPurposes(!e.showAll)})),f.Rb(3,"fa-icon",10),f.Vb(),f.Vb(),f.Ic(4,V,8,6,"div",11),f.Wb(5,"div",12),f.Kc(6,"\xa0"),f.Vb(),f.Wb(7,"a",13),f.Kc(8," Proceed to workbench "),f.Rb(9,"fa-icon",14),f.Vb(),f.Vb()}if(2&e){var s=f.kc();f.pc("ngClass",f.tc(3,W,s.fontSizeSmall)),f.Cb(3),f.pc("icon",s.showAll?"angle-double-down":"angle-double-right"),f.Cb(1),f.pc("ngForOf",s.purpose)}}var w,F=((w=function(){function e(t,i){_classCallCheck(this,e),this.cachingService=t,this.store$=i,this.edit=new f.n,this.showAll=!1,this.hideExtendedFields=!1,this.fontSizeSmall=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.selectedItem$=this.store$.select((function(e){return e.issue.selectedItem})).pipe(Object(g.a)((function(e){return e}))).subscribe((function(t){return e.selectedItem=t})),this.purpose$=this.store$.select((function(e){return e.issue.list})).pipe(Object(g.a)((function(e){return e}))).subscribe((function(t){e.purpose=t}))}},{key:"ngOnDestroy",value:function(){this.purpose$&&this.purpose$.unsubscribe(),this.hierarchySetupVisibility$&&this.hierarchySetupVisibility$.unsubscribe(),this.selectedItem$&&this.selectedItem$.unsubscribe()}},{key:"showHideAllPurposes",value:function(e){var t=this;this.showAll=e,this.purpose&&(this.purpose.forEach((function(e){return e.show=t.showAll})),!this.showAll&&this.purpose.length>0&&(this.purpose[this.purpose.length-1].show=!0))}}]),e}()).\u0275fac=function(e){return new(e||w)(f.Qb(m.a),f.Qb(n.h))},w.\u0275cmp=f.Kb({type:w,selectors:[["app-purpose"]],outputs:{edit:"edit"},decls:9,vars:3,consts:[[1,"row"],[1,"col-md-10"],[3,"ngClass",4,"ngIf"],[1,"col-md-2"],[1,"sticky-title","text-right"],[1,"btn","btn-light","btn-sm","mr-2",3,"disabled","click"],[1,"btn","btn-light",3,"disabled","click"],[3,"ngClass"],[1,"border-0","pb-0","mb-2","float-left"],["title","Show/hide details",1,"btn","btn-light","btn-sm","text-muted","mr-2",3,"click"],["size","fw",3,"icon"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"clearfix"],["routerLink","../workbench",1,"btn","btn-light","btn-sm","text-primary"],["icon","chevron-right","size","sm"],[1,"text-uppercase","text-muted"],[1,"small"],["class","ml-3 pl-3 pr-3 border-left","style","overflow:auto",4,"ngIf"],[1,"ml-3","pl-3","pr-3","border-left",2,"overflow","auto"],[1,"text-dark","font-weight-normal","mt-1"],[3,"data"]],template:function(e,t){1&e&&(f.Wb(0,"div",0),f.Wb(1,"div",1),f.Ic(2,j,10,5,"div",2),f.Vb(),f.Wb(3,"div",3),f.Wb(4,"div",4),f.Wb(5,"button",5),f.ic("click",(function(){return t.fontSizeSmall=!0})),f.Kc(6,"A"),f.Vb(),f.Wb(7,"button",6),f.ic("click",(function(){return t.fontSizeSmall=!1})),f.Kc(8,"A"),f.Vb(),f.Vb(),f.Vb(),f.Vb()),2&e&&(f.Cb(2),f.pc("ngIf",t.purpose&&t.purpose.length>0),f.Cb(3),f.pc("disabled",t.fontSizeSmall),f.Cb(2),f.pc("disabled",!t.fontSizeSmall))},directives:[s.l,s.j,v.a,s.k,I.f,k.a],encapsulation:2}),w),O=i("sITn"),x=i("3Pt+"),S=i("jLSX"),$=i("itXk"),E=i("lJxs"),R=i("LvOF"),T=i("F2Ol");function L(e,t){if(1&e&&(f.Wb(0,"span",18),f.Kc(1),f.Vb()),2&e){var i=t.$implicit;f.Cb(1),f.Lc(i)}}function K(e,t){if(1&e&&(f.Wb(0,"div",15),f.Wb(1,"span",16),f.Kc(2,"FIX VERSION: "),f.Vb(),f.Ic(3,L,2,1,"span",17),f.Vb()),2&e){var i=f.kc(2);f.Cb(3),f.pc("ngForOf",i.selectedItem.fixVersions)}}function z(e,t){1&e&&(f.Wb(0,"a",19),f.Rb(1,"fa-icon",20),f.Kc(2," Storyboard "),f.Vb()),2&e&&f.pc("routerLinkActive","active")}var P=function(){return["fab","jira"]},A=function(){return["details"]},M=function(){return["far","lightbulb"]},_=function(){return["far","window-restore"]};function B(e,t){if(1&e&&(f.Wb(0,"div",2),f.Wb(1,"div",3),f.Wb(2,"div"),f.Ic(3,K,4,1,"div",4),f.Wb(4,"sub",5),f.Kc(5),f.Wb(6,"a",6),f.Rb(7,"fa-icon",7),f.Vb(),f.Vb(),f.Vb(),f.Wb(8,"h2",8),f.Kc(9),f.Wb(10,"sup",9),f.Kc(11),f.Vb(),f.Vb(),f.Wb(12,"div",10),f.Wb(13,"a",11),f.Rb(14,"fa-icon",12),f.Kc(15," Purpose "),f.Vb(),f.Wb(16,"a",13),f.Rb(17,"fa-icon",12),f.Kc(18," Workbench "),f.Vb(),f.Ic(19,z,3,1,"a",14),f.Vb(),f.Vb(),f.Vb()),2&e){var i=f.kc();f.Cb(3),f.pc("ngIf",i.selectedItem.fixVersions&&i.selectedItem.fixVersions.length>0),f.Cb(2),f.Nc(" ",i.selectedItem.issueType,": ",i.selectedItem.key," "),f.Cb(1),f.qc("href",i.prepareExternalUrl(i.selectedItem.key),f.Dc),f.Cb(1),f.pc("icon",f.sc(13,P)),f.Cb(2),f.Mc(" ",i.selectedItem.title," "),f.Cb(2),f.Mc(" ",i.selectedItem.status," "),f.Cb(2),f.pc("routerLink",f.sc(14,A))("routerLinkActive","active"),f.Cb(1),f.pc("icon",f.sc(15,M)),f.Cb(2),f.pc("routerLinkActive","active"),f.Cb(1),f.pc("icon",f.sc(16,_)),f.Cb(2),f.pc("ngIf",i.canNavigateToStoryboard())}}var N,Q=((N=function(){function e(t,i,s,n,c){_classCallCheck(this,e),this.router=t,this.activatedRoute=i,this.cachingService=s,this.jiraService=n,this.store$=c,this.currentIssueKey=""}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.localNodeType=p.a,this.updatedField$=this.store$.select((function(e){return e.issue.updatedField})).pipe(Object(g.a)((function(e){return e}))).subscribe((function(t){return e.router.navigate([],{queryParams:{updated:t.issueKey}})})),this.organization$=this.store$.select((function(e){return e.app.organization})).pipe(Object(g.a)((function(e){return e}))).subscribe((function(t){return e.store$.dispatch(new d(t))})),this.currentIssueKey$=this.store$.select((function(e){return e.app.currentIssueKey})).pipe(Object(g.a)((function(e){return e&&e.length>0}))).subscribe((function(t){return e.currentIssueKey=t})),this.selectedItem$=this.store$.select((function(e){return e.issue.selectedItem})).pipe(Object(g.a)((function(e){return e}))).subscribe((function(t){return e.selectedItem=t})),this.epicChildrenLoadedQuery$=this.store$.select((function(e){return e.app.epicChildrenLoaded})).pipe(Object(g.a)((function(e){return!0===e}))),this.hierarchicalIssueQuery$=this.store$.select((function(e){return e.app.hierarchicalIssue})).pipe(Object(g.a)((function(e){return e}))),this.paramsQuery$=this.activatedRoute.params.pipe(Object(g.a)((function(e){return e&&e.selected&&e.selected.length>0})),Object(E.a)((function(e){return e.selected}))),this.queryParamsQuery$=this.activatedRoute.queryParams,this.projectsQuery$=this.store$.select((function(e){return e.app.projects})).pipe(Object(g.a)((function(e){return e}))),this.combined$=Object($.a)(this.hierarchicalIssueQuery$,this.paramsQuery$,this.queryParamsQuery$,this.projectsQuery$,this.epicChildrenLoadedQuery$).subscribe((function(t){var i=_slicedToArray(t,5),s=i[0],n=i[1],c=i[2],r=i[3],a=i[4];console.log("qp",c),e.selectItem(r,s,n,a)}))}},{key:"selectItem",value:function(e,t,i,s){var n=this;this.projects=e;var c=Object(p.p)(t,p.a.Project),a=Object(p.q)(t,i);if(c&&a){a.extendedFields=Object(R.a)(this.projects,c.key,a.issueType);var l=r.map(a.extendedFields,"id");this.jiraService.getIssueDetails(i,l).pipe(Object(g.a)((function(e){return null!=e&&e.fields}))).subscribe((function(t){Object(p.e)(Object(p.m)(t),a),a.extendedFields=r.map(a.extendedFields,(function(e){return e.value=t.fields[e.id],e}));var i=r.concat(p.o,["extendedFields","children"]),s=r.pick(a,i);s.project=r.find(e,{key:s.project.key}),n.store$.dispatch(new o(s))}))}setTimeout((function(){return n.markIssueSelected(a)}),500)}},{key:"ngOnDestroy",value:function(){this.updatedField$&&this.updatedField$.unsubscribe(),this.epicChildrenLoaded$&&this.epicChildrenLoaded$.unsubscribe(),this.organization$&&this.organization$.unsubscribe(),this.combined$&&this.combined$.unsubscribe(),this.selectedItem$&&this.selectedItem$.unsubscribe(),this.currentIssueKey$&&this.currentIssueKey$.unsubscribe()}},{key:"markIssueSelected",value:function(e){var t=this;if(e)if(this.projects&&e.project&&(e.extendedFields=Object(R.a)(this.projects,e.project.key,e.issueType)),!e.parent||e.parent.issueType!==p.a.RelatedLink||e.description&&0!==e.description.length)this.expandPurpose(e);else{var i=r.map(e.extendedFields,"id");this.jiraService.getIssueDetails(e.key,i).pipe(Object(g.a)((function(e){return null!=e}))).subscribe((function(i){var s=Object(p.m)(i);s&&Object(p.e)(s,e),e.extendedFields=r.map(e.extendedFields,(function(e){return e.value=i.fields[e.id],e})),t.expandPurpose(e)}))}}},{key:"expandPurpose",value:function(e){this.purpose=[],this.populatePurpose(e),r.reverse(this.purpose),this.purpose.length>0&&(this.purpose[this.purpose.length-1].show=!0),this.store$.dispatch(new u(this.purpose))}},{key:"populatePurpose",value:function(e){e&&(e.issueType!==p.a.EpicChildren&&e.issueType!==p.a.RelatedLink&&this.purpose.push({key:e.key,issueType:e.issueType,title:e.title,purpose:e.description,editable:e.editable,hfKey:e.hfKey,show:!1}),e.parent&&this.populatePurpose(e.parent))}},{key:"canNavigateToStoryboard",value:function(){return this.selectedItem&&("Epic"===this.selectedItem.issueType||this.currentIssueKey.toLowerCase()===this.selectedItem.key.toLowerCase())}},{key:"prepareExternalUrl",value:function(e){var t=this.cachingService.getConnectionDetails();return t&&t.serverUrl&&t.serverUrl.length>0?"".concat(t.serverUrl,"/browse/").concat(e):""}}]),e}()).\u0275fac=function(e){return new(e||N)(f.Qb(I.d),f.Qb(I.a),f.Qb(m.a),f.Qb(T.b),f.Qb(n.h))},N.\u0275cmp=f.Kb({type:N,selectors:[["app-container"]],decls:4,vars:1,consts:[[1,"pt-0","pr-3","pb-2","pl-3"],["class","pb-3",4,"ngIf"],[1,"pb-3"],[1,"border-bottom"],["class","float-right small mt-1",4,"ngIf"],[1,"text-uppercase","mr-2"],["target","_blank","title","View in jira",1,"ml-1",3,"href"],[1,"text-primary",3,"icon"],[1,"font-weight-light","mb-0"],[1,"badge","badge-light","text-uppercase","text-muted",2,"font-size","small"],[1,"pb-0"],["title","View purpose",1,"btn","btn-link","mr-1","pl-0",3,"routerLink","routerLinkActive"],["size","sm",3,"icon"],["routerLink","workbench",1,"btn","btn-link","mr-1",3,"routerLinkActive"],["class","btn btn-link mr-1","routerLink","storyboard",3,"routerLinkActive",4,"ngIf"],[1,"float-right","small","mt-1"],[1,"small","text-muted"],["class","badge badge-light ml-1",4,"ngFor","ngForOf"],[1,"badge","badge-light","ml-1"],["routerLink","storyboard",1,"btn","btn-link","mr-1",3,"routerLinkActive"],["icon","map","size","sm"]],template:function(e,t){1&e&&(f.Wb(0,"div",0),f.Ic(1,B,20,17,"div",1),f.Wb(2,"div"),f.Rb(3,"router-outlet"),f.Vb(),f.Vb()),2&e&&(f.Cb(1),f.pc("ngIf",t.selectedItem))},directives:[s.l,I.h,v.a,I.f,I.e,s.k],encapsulation:2}),N),U=i("1kSV"),X=i("cdP3");function D(e,t){1&e&&(f.Wb(0,"div",3),f.Rb(1,"fa-icon",4),f.Kc(2," There are no extended fields/attributes for this record. "),f.Vb())}var H=function(e){return{small:e}};function q(e,t){if(1&e&&(f.Wb(0,"div",8),f.Wb(1,"div",9),f.Kc(2),f.Vb(),f.Wb(3,"div",10),f.Rb(4,"ngx-md",11),f.Vb(),f.Vb()),2&e){var i=t.$implicit,s=f.kc(3);f.Cb(2),f.Lc(i.name),f.Cb(1),f.pc("ngClass",f.tc(3,H,s.fontSizeSmall)),f.Cb(1),f.pc("data",i.value)}}function J(e,t){if(1&e&&(f.Wb(0,"div",5),f.Wb(1,"div",6),f.Ic(2,q,5,5,"div",7),f.Vb(),f.Vb()),2&e){var i=f.kc(2);f.Cb(2),f.pc("ngForOf",i.issue.extendedFields)}}function G(e,t){if(1&e&&(f.Wb(0,"div"),f.Ic(1,D,3,0,"div",1),f.Ic(2,J,3,1,"div",2),f.Vb()),2&e){var i=f.kc();f.Cb(1),f.pc("ngIf",!i.issue.extendedFields||0===i.issue.extendedFields.length),f.Cb(1),f.pc("ngIf",i.issue.extendedFields&&i.issue.extendedFields.length>0)}}var Y,Z=((Y=function e(){_classCallCheck(this,e),this.fontSizeSmall=!1}).\u0275fac=function(e){return new(e||Y)},Y.\u0275cmp=f.Kb({type:Y,selectors:[["app-extended-fields"]],inputs:{issue:"issue"},decls:1,vars:1,consts:[[4,"ngIf"],["class","alert alert-warning",4,"ngIf"],["class","alert small",4,"ngIf"],[1,"alert","alert-warning"],["icon","exclamation-triangle",1,"text-warning"],[1,"alert","small"],[1,"list-group","list-group-flush","list-group-flush-compact"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[1,"small","text-uppercase","mb-2"],[1,"ml-4",3,"ngClass"],[3,"data"]],template:function(e,t){1&e&&f.Ic(0,G,3,2,"div",0),2&e&&f.pc("ngIf",t.issue)},directives:[s.l,v.a,s.k,s.j,k.a],encapsulation:2}),Y),ee=i("4xbw");function te(e,t){if(1&e){var i=f.Xb();f.Wb(0,"div",3),f.Rb(1,"app-issue-navigation",4),f.Wb(2,"button",5),f.ic("click",(function(){return f.Bc(i),f.kc(2).onClose()})),f.Rb(3,"fa-icon",6),f.Vb(),f.Wb(4,"span",7),f.Wb(5,"span",8),f.Kc(6),f.Vb(),f.Kc(7),f.Vb(),f.Rb(8,"ngx-md",9),f.Vb()}if(2&e){var s=f.kc(2);f.Cb(1),f.pc("issueKey",s.issue.key),f.Cb(5),f.Mc("",s.issue.key,":"),f.Cb(1),f.Mc(" ",s.issue.title," "),f.Cb(1),f.pc("data",s.issue.description)}}function ie(e,t){if(1&e){var i=f.Xb();f.Wb(0,"button",20),f.ic("click",(function(){return f.Bc(i),f.kc(3).showHideExtendedFields()})),f.Rb(1,"fa-icon",21),f.Vb()}if(2&e){var s=f.kc(3);f.Cb(1),f.pc("fixedWidth",!0)("icon",s.hideExtendedFields?"angle-double-right":"angle-double-down")}}function se(e,t){if(1&e&&(f.Wb(0,"span",8),f.Kc(1),f.Vb()),2&e){var i=f.kc(3);f.Cb(1),f.Mc(" ",i.filteredItems.length," ")}}function ne(e,t){if(1&e){var i=f.Xb();f.Wb(0,"button",22),f.ic("click",(function(){f.Bc(i);var e=f.kc(3);return e.tasklistFilterVisible=!e.tasklistFilterVisible})),f.Rb(1,"fa-icon",23),f.Vb()}if(2&e){var s=f.kc(3);f.Cb(1),f.pc("icon",s.tasklistFilterVisible?"chevron-up":"filter")}}function ce(e,t){if(1&e&&(f.Wb(0,"option",28),f.Kc(1),f.Vb()),2&e){var i=t.$implicit;f.pc("value",i.key),f.Cb(1),f.Mc(" ",i.key+" ("+i.count+")","")}}function re(e,t){if(1&e){var i=f.Xb();f.Wb(0,"div",24),f.Wb(1,"select",25),f.ic("ngModelChange",(function(e){return f.Bc(i),f.kc(3).issueTypeFilter=e}))("change",(function(){return f.Bc(i),f.kc(3).onFilterChanged()})),f.Wb(2,"option",26),f.Kc(3,"ISSUE TYPE: All"),f.Vb(),f.Ic(4,ce,2,2,"option",27),f.Vb(),f.Vb()}if(2&e){var s=f.kc(3);f.Cb(1),f.pc("ngModel",s.issueTypeFilter),f.Cb(3),f.pc("ngForOf",s.issueTypeStats)}}function ae(e,t){if(1&e&&(f.Wb(0,"option",28),f.Kc(1),f.Vb()),2&e){var i=t.$implicit;f.pc("value",i.key),f.Cb(1),f.Mc(" ",i.key+" ("+i.count+")","")}}function le(e,t){if(1&e){var i=f.Xb();f.Wb(0,"div",24),f.Wb(1,"select",25),f.ic("ngModelChange",(function(e){return f.Bc(i),f.kc(3).statusFilter=e}))("change",(function(){return f.Bc(i),f.kc(3).onFilterChanged()})),f.Wb(2,"option",26),f.Kc(3,"STATUS: All"),f.Vb(),f.Ic(4,ae,2,2,"option",27),f.Vb(),f.Vb()}if(2&e){var s=f.kc(3);f.Cb(1),f.pc("ngModel",s.statusFilter),f.Cb(3),f.pc("ngForOf",s.statusStats)}}function oe(e,t){if(1&e){var i=f.Xb();f.Wb(0,"button",36),f.ic("click",(function(){f.Bc(i);var e=f.kc().$implicit;return e.hideExtendedFields=!e.hideExtendedFields})),f.Rb(1,"fa-icon",21),f.Vb()}if(2&e){var s=f.kc().$implicit;f.Cb(1),f.pc("fixedWidth",!0)("icon",s.hideExtendedFields?"angle-right":"angle-down")}}function ue(e,t){if(1&e&&(f.Wb(0,"tr"),f.Wb(1,"td",40),f.Kc(2),f.Vb(),f.Wb(3,"td",41),f.Kc(4),f.Vb(),f.Vb()),2&e){var i=t.$implicit;f.Cb(2),f.Mc("",i.name,":"),f.Cb(2),f.Mc(" ",i.value," ")}}function de(e,t){if(1&e&&(f.Wb(0,"div",37),f.Wb(1,"table",38),f.Ic(2,ue,5,2,"tr",39),f.Vb(),f.Vb()),2&e){var i=f.kc().$implicit;f.Cb(2),f.pc("ngForOf",i.extendedFields)}}var be=function(e){return{"ml-4":e}};function pe(e,t){if(1&e&&(f.Wb(0,"div",29),f.Ic(1,oe,2,2,"button",30),f.Wb(2,"small",31),f.Kc(3),f.Vb(),f.Wb(4,"small",32),f.Wb(5,"span",33),f.Kc(6),f.Vb(),f.Kc(7),f.Vb(),f.Wb(8,"div",34),f.Wb(9,"div"),f.Kc(10),f.Vb(),f.Ic(11,de,3,1,"div",35),f.Vb(),f.Vb()),2&e){var i=t.$implicit,s=f.kc(3);f.Cb(1),f.pc("ngIf",s.hasExtendedFields),f.Cb(2),f.Lc(i.status),f.Cb(3),f.Lc(i.issueType),f.Cb(1),f.Mc(": ",i.key," "),f.Cb(1),f.pc("ngClass",f.tc(7,be,s.hasExtendedFields)),f.Cb(2),f.Lc(i.title),f.Cb(1),f.pc("ngIf",!i.hideExtendedFields&&i.extendedFields&&i.extendedFields.length>0)}}function he(e,t){if(1&e&&(f.Wb(0,"div"),f.Wb(1,"div",10),f.Wb(2,"div",11),f.Wb(3,"div",12),f.Ic(4,ie,2,2,"button",13),f.Wb(5,"b",14),f.Ic(6,se,2,1,"span",15),f.Kc(7),f.Vb(),f.Ic(8,ne,2,1,"button",16),f.Vb(),f.Wb(9,"div",17),f.Ic(10,re,5,2,"div",18),f.Ic(11,le,5,2,"div",18),f.Vb(),f.Vb(),f.Ic(12,pe,12,9,"div",19),f.Vb(),f.Vb()),2&e){var i=f.kc(2);f.Cb(4),f.pc("ngIf",i.hasExtendedFields),f.Cb(2),f.pc("ngIf",i.filteredItems.length>0),f.Cb(1),f.Mc(" record",i.filteredItems.length>1?"s":"",""),f.Cb(1),f.pc("ngIf",i.issueTypeStats&&i.issueTypeStats.length>1||i.statusStats&&i.statusStats.length>1),f.Cb(1),f.pc("ngbCollapse",!i.tasklistFilterVisible),f.Cb(1),f.pc("ngIf",i.issueTypeStats&&i.issueTypeStats.length>1),f.Cb(1),f.pc("ngIf",i.statusStats&&i.statusStats.length>1),f.Cb(1),f.pc("ngForOf",i.filteredItems)}}function fe(e,t){1&e&&(f.Wb(0,"div",42),f.Kc(1," No detail records found. "),f.Vb())}function ge(e,t){if(1&e&&(f.Wb(0,"div"),f.Ic(1,te,9,4,"div",1),f.Ic(2,he,13,8,"div",0),f.Ic(3,fe,2,0,"div",2),f.Vb()),2&e){var i=f.kc();f.Cb(1),f.pc("ngIf",i.showIssue),f.Cb(1),f.pc("ngIf",i.filteredItems&&i.filteredItems.length>0),f.Cb(1),f.pc("ngIf",i.filteredItems&&0===i.filteredItems.length)}}var me,ve=((me=function(){function e(t,i,s){_classCallCheck(this,e),this.jiraService=t,this.cachingService=i,this.store$=s,this.close=new f.n,this.tasklistFilterVisible=!1,this.childIssueType="",this.hasExtendedFields=!1,this.showDetails=!1,this.hideExtendedFields=!0,this.statusFilter="all",this.issueTypeFilter="all"}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.currentProject$=this.store$.select((function(e){return e.app.currentProjectUpdated})).subscribe((function(){return e.loadDetails()}))}},{key:"ngOnDestroy",value:function(){this.currentProject$&&this.currentProject$.unsubscribe()}},{key:"loadDetails",value:function(){var e=this;if(this.issue&&this.issue.project&&this.issue.project.subTaskIssueTypes&&this.issue.project.subTaskIssueTypes.length>0){var t=r.join(r.map(this.issue.project.subTaskIssueTypes,(function(e){return"'".concat(e.name,"'")})),","),i=r.spread(r.union)(r.map(this.issue.project.subTaskIssueTypes,"list"));this.hasExtendedFields=i&&i.length>0;var s=r.map(i,"id");this.jiraService.executeJql("issuetype in (".concat(t,") AND parent=").concat(this.issue.key),0,100,s,"test-cases.json").pipe(Object(g.a)((function(e){return e&&e.issues}))).subscribe((function(t){e.childItems=Object(p.h)(t.issues),e.childItems.forEach((function(t){return t.hideExtendedFields=e.hideExtendedFields})),Object(p.c)(e.childItems,i),e.onFilterChanged(),e.populateStatistics()}))}}},{key:"populateStatistics",value:function(){var e=r.mapValues(r.groupBy(r.map(this.childItems,"status")),(function(e){return e.length}));this.statusStats=Object.keys(e).map((function(t){return{key:t,count:e[t]}}));var t=r.mapValues(r.groupBy(r.map(this.childItems,"issueType")),(function(e){return e.length}));this.issueTypeStats=Object.keys(t).map((function(e){return{key:e,count:t[e]}}))}},{key:"onFilterChanged",value:function(){var e=this;this.filteredItems=r.filter(this.childItems,(function(t){return!(e.statusFilter&&"all"!==e.statusFilter&&t.status!==e.statusFilter||e.issueTypeFilter&&"all"!==e.issueTypeFilter&&t.issueType!==e.issueTypeFilter)})),this.filteredItems=r.orderBy(this.filteredItems,["issueType","status"])}},{key:"showHideExtendedFields",value:function(){var e=this;this.hideExtendedFields=!this.hideExtendedFields,this.childItems&&this.childItems.forEach((function(t){return t.hideExtendedFields=e.hideExtendedFields}))}},{key:"onClose",value:function(){this.close.emit(!0)}},{key:"issue",set:function(e){this._issue=e,this.loadDetails()},get:function(){return this._issue}}]),e}()).\u0275fac=function(e){return new(e||me)(f.Qb(T.b),f.Qb(m.a),f.Qb(n.h))},me.\u0275cmp=f.Kb({type:me,selectors:[["app-task-list"]],inputs:{issue:"issue",showIssue:"showIssue"},outputs:{close:"close"},decls:1,vars:1,consts:[[4,"ngIf"],["class","alert bg-light pl-0 mb-0","style","font-size:medium;",4,"ngIf"],["class","alert alert-warning mt-2",4,"ngIf"],[1,"alert","bg-light","pl-0","mb-0",2,"font-size","medium"],[1,"float-right",3,"issueKey"],[1,"btn","btn-sm","btn-link","mr-2",3,"click"],["icon","chevron-left","size","lg"],[1,"pt-2"],[1,"mr-1"],[3,"data"],[1,"list-group","list-group-flush","list-group-flush-compact"],[1,"list-group-item","list-group-item-light"],[1,"clearfix"],["class","btn btn-sm btn-link text-muted pl-0","title","Show/hide details",3,"click",4,"ngIf"],[1,"mt-1"],["class","mr-1",4,"ngIf"],["class","btn btn-link btn-sm float-right","title","Filters",3,"click",4,"ngIf"],[1,"row","ml-3",3,"ngbCollapse"],["class","col-md-6",4,"ngIf"],["class","list-group-item",4,"ngFor","ngForOf"],["title","Show/hide details",1,"btn","btn-sm","btn-link","text-muted","pl-0",3,"click"],["size","sm",3,"fixedWidth","icon"],["title","Filters",1,"btn","btn-link","btn-sm","float-right",3,"click"],["size","sm",3,"icon"],[1,"col-md-6"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange","change"],["value","all"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"list-group-item"],["class","btn btn-link btn-sm text-muted pl-0 pt-0","title","Show/hide details",3,"click",4,"ngIf"],[1,"float-right","badge","badge-light","font-weight-light","text-uppercase"],[1,"text-muted"],[1,"text-uppercase"],[3,"ngClass"],["style","overflow: auto;","class","alert mt-2 p-0 rounded-0 border-0",4,"ngIf"],["title","Show/hide details",1,"btn","btn-link","btn-sm","text-muted","pl-0","pt-0",3,"click"],[1,"alert","mt-2","p-0","rounded-0","border-0",2,"overflow","auto"],[1,"table","table-small","m-0","border-0","bg-light","extended-fields"],[4,"ngFor","ngForOf"],["width","10%",1,"p-1","text-nowrap","text-muted"],["Markdown","",1,"p-1","text-dark"],[1,"alert","alert-warning","mt-2"]],template:function(e,t){1&e&&f.Ic(0,ge,4,3,"div",0),2&e&&f.pc("ngIf",t.issue)},directives:[s.l,ee.a,v.a,k.a,U.b,s.k,x.k,x.f,x.i,x.j,x.l,s.j],encapsulation:2}),me),Ie=["content"];function ke(e,t){if(1&e&&f.Rb(0,"app-extended-fields",17),2&e){var i=f.kc(2);f.pc("issue",i.issue)}}function ye(e,t){if(1&e&&f.Rb(0,"fa-icon",20),2&e){var i=f.kc(3);f.pc("icon",i.allEpicChildrenVisible?"angle-double-down":"angle-double-right")("fixedWidth",!0)}}function Ce(e,t){1&e&&(f.Wb(0,"div",24),f.Kc(1," There are no issues in this epic "),f.Vb())}function Ve(e,t){if(1&e){var i=f.Xb();f.Wb(0,"div",34),f.Rb(1,"app-issue-navigation",35),f.Wb(2,"div",36),f.Kc(3),f.Vb(),f.Rb(4,"i",37),f.Wb(5,"a",38),f.ic("click",(function(){f.Bc(i);var e=t.$implicit;return f.kc(8).selectEpicIssue(e)})),f.Kc(6),f.Vb(),f.Kc(7),f.Vb()}if(2&e){var s=t.$implicit;f.Cb(1),f.pc("issueKey",s.key),f.Cb(2),f.Mc(" ",s.duedate," "),f.Cb(1),f.Eb(s.icon),f.Cb(2),f.Lc(s.key),f.Cb(1),f.Mc(" ",s.title," ")}}function We(e,t){if(1&e&&(f.Wb(0,"div",32),f.Ic(1,Ve,8,6,"div",33),f.Vb()),2&e){var i=f.kc().$implicit;f.Cb(1),f.pc("ngForOf",i.children)}}var je=function(e){return{"w-100 btn-light ":e}};function we(e,t){if(1&e&&(f.Wb(0,"div"),f.Wb(1,"div",28),f.Wb(2,"button",29),f.ic("click",(function(){var e=t.$implicit;return e.visible=!e.visible})),f.Rb(3,"fa-icon",20),f.Wb(4,"span",30),f.Kc(5),f.Vb(),f.Vb(),f.Vb(),f.Ic(6,We,2,1,"div",31),f.Vb()),2&e){var i=t.$implicit;f.Cb(2),f.pc("ngClass",f.tc(6,je,i.visible)),f.Cb(1),f.pc("icon",i.visible?"angle-down":"angle-right")("fixedWidth",!0),f.Cb(2),f.Nc("",i.label," / ",i.total,""),f.Cb(1),f.pc("ngIf",i.visible)}}function Fe(e,t){if(1&e&&(f.Wb(0,"div"),f.Ic(1,we,7,8,"div",25),f.Wb(2,"a",26),f.Kc(3," Storyboard view "),f.Rb(4,"fa-icon",27),f.Vb(),f.Vb()),2&e){var i=f.kc(5);f.Cb(1),f.pc("ngForOf",i.groupedEpicChildren)}}function Oe(e,t){if(1&e){var i=f.Xb();f.Wb(0,"div"),f.Wb(1,"app-task-list",39),f.ic("close",(function(){return f.Bc(i),f.kc(5).resetSelectedEpicIssue()})),f.Vb(),f.Vb()}if(2&e){var s=f.kc(5);f.Cb(1),f.pc("issue",s.selectedEpicIssue)("showIssue",!0)}}function xe(e,t){if(1&e&&(f.Wb(0,"div"),f.Ic(1,Fe,5,1,"div",23),f.Ic(2,Oe,2,2,"div",23),f.Vb()),2&e){var i=f.kc(4);f.Cb(1),f.pc("ngIf",!i.selectedEpicIssue),f.Cb(1),f.pc("ngIf",i.selectedEpicIssue)}}function Se(e,t){if(1&e&&(f.Wb(0,"div",21),f.Ic(1,Ce,2,0,"div",22),f.Ic(2,xe,3,2,"div",23),f.Vb()),2&e){var i=f.kc(3);f.Cb(1),f.pc("ngIf",i.groupedEpicChildren&&0===i.groupedEpicChildren.length),f.Cb(1),f.pc("ngIf",i.groupedEpicChildren&&i.groupedEpicChildren.length>0)}}function $e(e,t){if(1&e){var i=f.Xb();f.Wb(0,"li",13),f.Wb(1,"a",18),f.ic("click",(function(){return f.Bc(i),f.kc(2).toggleAllEpicChildren()})),f.Ic(2,ye,1,2,"fa-icon",19),f.Kc(3," Issues in this epic "),f.Vb(),f.Ic(4,Se,3,2,"ng-template",15),f.Vb()}if(2&e){var s=f.kc(2);f.pc("ngbNavItem",1),f.Cb(2),f.pc("ngIf",s.groupedEpicChildren&&s.groupedEpicChildren.length>1)}}function Ee(e,t){if(1&e&&f.Rb(0,"fa-icon",20),2&e){var i=f.kc(3);f.pc("icon",i.allRelatedIssuesVisible?"angle-double-down":"angle-double-right")("fixedWidth",!0)}}function Re(e,t){if(1&e&&(f.Wb(0,"span"),f.Kc(1),f.Vb()),2&e){var i=f.kc(2).$implicit;f.Cb(1),f.Mc(" / ",i.children.length,"")}}function Te(e,t){if(1&e){var i=f.Xb();f.Wb(0,"div",41),f.Rb(1,"app-issue-navigation",35),f.Wb(2,"div",36),f.Kc(3),f.Vb(),f.Rb(4,"i",37),f.Wb(5,"a",38),f.ic("click",(function(){f.Bc(i);var e=t.$implicit;return f.kc(8).selectRelatedIssue(e)})),f.Kc(6),f.Vb(),f.Kc(7),f.Vb()}if(2&e){var s=t.$implicit;f.pc("title",s.issueType),f.Cb(1),f.pc("issueKey",s.key),f.Cb(2),f.Mc(" ",s.status," "),f.Cb(1),f.Eb(s.icon),f.Cb(2),f.Lc(s.key),f.Cb(1),f.Mc(" ",s.title," ")}}function Le(e,t){if(1&e&&(f.Wb(0,"div",32),f.Ic(1,Te,8,7,"div",40),f.Vb()),2&e){var i=f.kc(2).$implicit;f.Cb(1),f.pc("ngForOf",i.children)}}function Ke(e,t){if(1&e){var i=f.Xb();f.Ub(0),f.Wb(1,"div",28),f.Wb(2,"button",29),f.ic("click",(function(){f.Bc(i);var e=f.kc().$implicit;return e.visible=!e.visible})),f.Rb(3,"fa-icon",20),f.Wb(4,"span",30),f.Kc(5),f.Ic(6,Re,2,1,"span",23),f.Vb(),f.Vb(),f.Vb(),f.Ic(7,Le,2,1,"div",31),f.Tb()}if(2&e){var s=f.kc().$implicit;f.Cb(2),f.pc("ngClass",f.tc(6,je,s.visible)),f.Cb(1),f.pc("icon",s.visible?"angle-down":"angle-right")("fixedWidth",!0),f.Cb(2),f.Mc("",s.label," "),f.Cb(1),f.pc("ngIf",s.children),f.Cb(1),f.pc("ngIf",s.visible)}}function ze(e,t){if(1&e&&(f.Wb(0,"div"),f.Ic(1,Ke,8,8,"ng-container",23),f.Vb()),2&e){var i=t.$implicit,s=f.kc(5);f.Cb(1),f.pc("ngIf",i.issueType!==s.localNodeType.EpicChildren)}}function Pe(e,t){if(1&e&&(f.Wb(0,"div"),f.Ic(1,ze,2,1,"div",25),f.Vb()),2&e){var i=f.kc(4);f.Cb(1),f.pc("ngForOf",i.issue.children)}}function Ae(e,t){if(1&e){var i=f.Xb();f.Wb(0,"div"),f.Wb(1,"app-task-list",39),f.ic("close",(function(){return f.Bc(i),f.kc(4).resetSelectedRelatedIssue()})),f.Vb(),f.Vb()}if(2&e){var s=f.kc(4);f.Cb(1),f.pc("issue",s.selectedRelatedIssue)("showIssue",!0)}}function Me(e,t){if(1&e&&(f.Wb(0,"div",21),f.Ic(1,Pe,2,1,"div",23),f.Ic(2,Ae,2,2,"div",23),f.Vb()),2&e){var i=f.kc(3);f.Cb(1),f.pc("ngIf",!i.selectedRelatedIssue),f.Cb(1),f.pc("ngIf",i.selectedRelatedIssue)}}function _e(e,t){if(1&e){var i=f.Xb();f.Wb(0,"li",13),f.Wb(1,"a",18),f.ic("click",(function(){return f.Bc(i),f.kc(2).toggleAllRelatedIssues()})),f.Ic(2,Ee,1,2,"fa-icon",19),f.Kc(3," Related "),f.Vb(),f.Ic(4,Me,3,2,"ng-template",15),f.Vb()}if(2&e){var s=f.kc(2);f.pc("ngbNavItem",2),f.Cb(2),f.pc("ngIf",s.issue.relatedLinksCount>1)}}function Be(e,t){if(1&e&&(f.Wb(0,"div",21),f.Rb(1,"app-task-list",42),f.Vb()),2&e){var i=f.kc(2);f.Cb(1),f.pc("issue",i.issue)("showIssue",!1)}}var Ne=function(e){return{small:e}};function Qe(e,t){if(1&e){var i=f.Xb();f.Wb(0,"as-split",2),f.ic("gutterDblClick",(function(){return f.Bc(i),f.kc().toggleFullscreen()}))("dragEnd",(function(e){return f.Bc(i),f.kc().dragEnd(e)})),f.Wb(1,"as-split-area",3),f.Wb(2,"div",4),f.Rb(3,"ngx-md",5),f.Ic(4,ke,1,1,"app-extended-fields",6),f.Vb(),f.Vb(),f.Wb(5,"as-split-area",7),f.Wb(6,"button",8),f.ic("click",(function(){return f.Bc(i),f.kc().toggleFullscreen()})),f.Rb(7,"fa-icon",9),f.Vb(),f.Wb(8,"ul",10,11),f.ic("activeIdChange",(function(e){return f.Bc(i),f.kc().selectedTab=e})),f.Ic(10,$e,5,2,"li",12),f.Ic(11,_e,5,2,"li",12),f.Wb(12,"li",13),f.Wb(13,"a",14),f.Kc(14,"Task breakup"),f.Vb(),f.Ic(15,Be,2,2,"ng-template",15),f.Vb(),f.Vb(),f.Rb(16,"div",16),f.Vb(),f.Vb()}if(2&e){var s=f.Ac(9),n=f.kc();f.Cb(1),f.pc("size",n.columns[0].size),f.Cb(2),f.pc("data",n.issue.description),f.Cb(1),f.pc("ngIf",n.leftPaneSize>0),f.Cb(1),f.pc("size",n.columns[1].size)("ngClass",f.tc(13,Ne,0!==n.columns[0].size)),f.Cb(2),f.pc("icon",0===n.columns[0].size?"compress-arrows-alt":"expand-arrows-alt")("fixedWidth",!0),f.Cb(1),f.pc("activeId",n.selectedTab)("destroyOnHide",!1),f.Cb(2),f.pc("ngIf",n.issue.issueType===n.localNodeType.Epic),f.Cb(1),f.pc("ngIf",n.issue.relatedLinksCount>0),f.Cb(1),f.pc("ngbNavItem",3),f.Cb(4),f.pc("ngbNavOutlet",s)}}var Ue,Xe=((Ue=function(){function e(t,i){var s=this;_classCallCheck(this,e),this.cdRef=t,this.store$=i,this.allRelatedIssuesVisible=!0,this.allEpicChildrenVisible=!0,this.contentHeight=0,this.selectedTab=1,this.leftPaneSize=55,this.columns=[{visible:!0,size:55},{visible:!0,size:40}],this.resetSelectedRelatedIssue=function(){return s.selectedRelatedIssue=null},this.resetSelectedEpicIssue=function(){return s.selectedEpicIssue=null},this.localNodeType=p.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.epicChildrenLoaded$=this.store$.select((function(e){return e.app.epicChildrenLoaded})).pipe(Object(g.a)((function(e){return!0===e}))).subscribe((function(){return e.groupEpicChildren("status")})),this.issue$=this.store$.select((function(e){return e.issue.selectedItem})).pipe(Object(g.a)((function(e){return e}))).subscribe((function(t){e.issue=t;var i=r.filter(e.issue.children,{issueType:p.a.RelatedLink});e.issue.relatedLinksCount=i.length,e.selectedTab=e.issue.relatedLinksCount>0?2:3,e.toggleAllRelatedIssues(),e.issue.issueType===p.a.Epic&&e.groupEpicChildren("status")}))}},{key:"ngOnDestroy",value:function(){this.epicChildrenLoaded$&&this.epicChildrenLoaded$.unsubscribe(),this.issue$&&this.issue$.unsubscribe()}},{key:"ngAfterViewInit",value:function(){this.contentHeight=this.elementView.nativeElement.offsetParent.clientHeight-134,this.cdRef.detectChanges()}},{key:"dragEnd",value:function(e){this.adjustPaneSize(e.sizes[0])}},{key:"adjustPaneSize",value:function(e){this.leftPaneSize=e,this.columns[0].size=e,this.columns[1].size=100-e}},{key:"toggleFullscreen",value:function(){this.adjustPaneSize(0===this.leftPaneSize?55:0)}},{key:"selectRelatedIssue",value:function(e){this.selectedRelatedIssue=e,this.selectedRelatedIssue.project=this.issue.project}},{key:"selectEpicIssue",value:function(e){this.selectedEpicIssue=e,this.selectedEpicIssue.project=this.issue.project}},{key:"groupEpicChildren",value:function(e){if(this.selectedTab=1,this.issue&&!this.groupedEpicChildren){var t=r.find(this.issue.children,{issueType:p.a.EpicChildren});t&&t.children&&t.children.length>0&&(this.groupedEpicChildren=this.groupChildren(t.children,e)),this.toggleAllEpicChildren()}}},{key:"groupChildren",value:function(e,t){var i=r.groupBy(e,t);return Object.keys(i).map((function(e){return{label:e,total:i[e].length,children:i[e]}}))}},{key:"toggleAllEpicChildren",value:function(){var e=this;this.allEpicChildrenVisible=!this.allEpicChildrenVisible,this.groupedEpicChildren&&this.groupedEpicChildren.forEach((function(t){return t.visible=1===e.groupedEpicChildren.length||e.allEpicChildrenVisible}))}},{key:"toggleAllRelatedIssues",value:function(){var e=this;this.allRelatedIssuesVisible=!this.allRelatedIssuesVisible,this.issue&&this.issue.relatedLinksCount>0&&r.filter(this.issue.children,{issueType:p.a.RelatedLink}).forEach((function(t){return t.visible=1===e.issue.relatedLinksCount||e.allRelatedIssuesVisible}))}}]),e}()).\u0275fac=function(e){return new(e||Ue)(f.Qb(f.h),f.Qb(n.h))},Ue.\u0275cmp=f.Kb({type:Ue,selectors:[["app-workbench"]],viewQuery:function(e,t){var i;1&e&&f.Oc(Ie,!0),2&e&&f.zc(i=f.jc())&&(t.elementView=i.first)},decls:3,vars:3,consts:[["content",""],["direction","horizontal",3,"gutterDblClick","dragEnd",4,"ngIf"],["direction","horizontal",3,"gutterDblClick","dragEnd"],[3,"size"],[1,"mr-5","alert","bg-light",2,"overflow","auto"],[3,"data"],[3,"issue",4,"ngIf"],[3,"size","ngClass"],["title","expand/collapse pane",1,"btn","btn-sm","btn-link","text-muted","float-right",3,"click"],[3,"icon","fixedWidth"],["ngbNav","",1,"nav-tabs",3,"activeId","destroyOnHide","activeIdChange"],["nav","ngbNav"],[3,"ngbNavItem",4,"ngIf"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-2",3,"ngbNavOutlet"],[3,"issue"],["ngbNavLink","",3,"click"],["size","sm",3,"icon","fixedWidth",4,"ngIf"],["size","sm",3,"icon","fixedWidth"],[1,"pl-2","pr-2","pb-2"],["class","alert alert-warning",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-warning"],[4,"ngFor","ngForOf"],["routerLink","../storyboard",1,"btn","btn-light","btn-sm","text-primary","mt-4"],["icon","chevron-right","size","sm"],[1,"text-muted","text-uppercase","mt-1","mb-1"],[1,"btn","btn-sm","btn-link","text-left","text-dark",3,"ngClass","click"],[1,"ml-2"],["class","mb-4",4,"ngIf"],[1,"mb-4"],["class","ml-3 p-1 border-bottom",4,"ngFor","ngForOf"],[1,"ml-3","p-1","border-bottom"],[1,"float-right",3,"issueKey"],[1,"badge","badge-light","font-weight-normal","text-uppercase","float-right","mt-1"],[1,"mr-1"],[1,"text-primary","mr-2",3,"click"],[3,"issue","showIssue","close"],["class","ml-3 p-1 border-bottom",3,"title",4,"ngFor","ngForOf"],[1,"ml-3","p-1","border-bottom",3,"title"],[3,"issue","showIssue"]],template:function(e,t){1&e&&(f.Wb(0,"div",null,0),f.Ic(2,Qe,17,15,"as-split",1),f.Vb()),2&e&&(f.Hc("height",t.contentHeight,"px"),f.Cb(2),f.pc("ngIf",t.issue))},directives:[s.l,X.c,X.b,k.a,s.j,v.a,U.j,U.l,U.m,U.k,U.o,Z,s.k,I.f,ee.a,ve],encapsulation:2}),Ue),De=i("iLqC"),He=i("Ewkv"),qe=i("/RsI"),Je=i("NGyg");function Ge(e,t){if(1&e){var i=f.Xb();f.Wb(0,"div"),f.Wb(1,"input",12),f.ic("ngModelChange",(function(e){return f.Bc(i),f.kc(3).includeEpicChildren=e}))("change",(function(){return f.Bc(i),f.kc(3).plotIssuesOnStoryboard()})),f.Vb(),f.Wb(2,"b",13),f.Kc(3),f.Vb(),f.Kc(4," issues in this epic "),f.Vb()}if(2&e){var s=f.kc(3);f.Cb(1),f.pc("ngModel",s.includeEpicChildren),f.Cb(2),f.Lc(s.storyboardItem.epicChildren.length)}}function Ye(e,t){if(1&e){var i=f.Xb();f.Wb(0,"div"),f.Wb(1,"input",12),f.ic("ngModelChange",(function(e){return f.Bc(i),f.kc(3).includeRelatedIssues=e}))("change",(function(){return f.Bc(i),f.kc(3).plotIssuesOnStoryboard()})),f.Vb(),f.Wb(2,"b",13),f.Kc(3),f.Vb(),f.Kc(4," related issues "),f.Vb()}if(2&e){var s=f.kc(3);f.Cb(1),f.pc("ngModel",s.includeRelatedIssues),f.Cb(2),f.Lc(s.storyboardItem.relatedLinks.length)}}function Ze(e,t){if(1&e&&(f.Wb(0,"div",10),f.Ic(1,Ge,5,2,"div",11),f.Ic(2,Ye,5,2,"div",11),f.Vb()),2&e){var i=f.kc(2);f.Cb(1),f.pc("ngIf",i.storyboardItem.epicChildren&&i.storyboardItem.epicChildren.length>0),f.Cb(1),f.pc("ngIf",i.storyboardItem.relatedLinks&&i.storyboardItem.relatedLinks.length>0)}}function et(e,t){if(1&e&&(f.Wb(0,"div",16),f.Wb(1,"span",17),f.Kc(2),f.Vb(),f.Kc(3," unplanned issues. "),f.Vb()),2&e){var i=f.kc(3);f.Cb(2),f.Lc(i.storyboardItem.metadata.backlogCount)}}function tt(e,t){if(1&e&&(f.Wb(0,"div"),f.Wb(1,"span",17),f.Kc(2),f.Vb(),f.Kc(3," issues in unknown functional areas. "),f.Vb()),2&e){var i=f.kc(3);f.Cb(2),f.Lc(i.storyboardItem.metadata.noComponentCount)}}function it(e,t){if(1&e&&(f.Wb(0,"div",14),f.Ic(1,et,4,1,"div",15),f.Ic(2,tt,4,1,"div",11),f.Vb()),2&e){var i=f.kc(2);f.Cb(1),f.pc("ngIf",i.storyboardItem.metadata.backlogCount>0),f.Cb(1),f.pc("ngIf",i.storyboardItem.metadata.noComponentCount>0)}}function st(e,t){if(1&e){var i=f.Xb();f.Wb(0,"p-dialog",18),f.ic("visibleChange",(function(e){return f.Bc(i),f.kc(2).showStatistics=e})),f.Rb(1,"app-statistics",19),f.Vb()}if(2&e){var s=f.kc(2);f.pc("visible",s.showStatistics),f.Cb(1),f.pc("statusStats",s.storyboardItem.statistics.status)("issueTypeStats",s.storyboardItem.statistics.issueTypes)("componentStats",s.storyboardItem.statistics.components)}}var nt=function(){return["far","chart-bar"]};function ct(e,t){if(1&e){var i=f.Xb();f.Wb(0,"div",1),f.Wb(1,"div",2),f.Ic(2,Ze,3,2,"div",3),f.Ic(3,it,3,2,"div",4),f.Wb(4,"div",5),f.Wb(5,"button",6),f.ic("click",(function(){return f.Bc(i),f.kc().showStatistics=!0})),f.Rb(6,"fa-icon",7),f.Vb(),f.Vb(),f.Vb(),f.Wb(7,"app-storyboard-renderer",8),f.ic("fieldValueChange",(function(e){return f.Bc(i),f.kc().onFieldValueChanged(e)})),f.Vb(),f.Ic(8,st,2,4,"p-dialog",9),f.Vb()}if(2&e){var s=f.kc();f.Cb(2),f.pc("ngIf",s.storyboardItem.epicChildren&&s.storyboardItem.epicChildren.length>0||s.storyboardItem.relatedLinks&&s.storyboardItem.relatedLinks.length>0),f.Cb(1),f.pc("ngIf",s.storyboardItem.metadata&&(s.storyboardItem.metadata.backlogCount>0||s.storyboardItem.metadata.noComponentCount>0)),f.Cb(3),f.pc("icon",f.sc(5,nt)),f.Cb(1),f.pc("storyboardItem",s.storyboardItem),f.Cb(1),f.pc("ngIf",s.storyboardItem&&s.storyboardItem.statistics)}}var rt,at,lt=((rt=function(){function e(t,i,s,n){_classCallCheck(this,e),this.activatedRoute=t,this.cachingService=i,this.jiraService=s,this.store$=n,this.includeRelatedIssues=!1,this.includeEpicChildren=!1,this.relatedIssuesIncluded=!1,this.epicChildrenIncluded=!1,this.showStatistics=!1,this.fieldlist=["key","project","title","status","components","fixVersions","labels","issueType","linkType"]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.localNodeType=p.a,this.selectedItem$=this.store$.select((function(e){return e.issue.selectedItem})).pipe(Object(g.a)((function(e){return e}))).subscribe((function(t){console.log("selectedItem",t);var i=t;if(i){e.storyboardItem=r.pick(i,e.fieldlist),e.storyboardItem.children=[],e.storyboardItem.metadata=Object(De.b)();var s=r.filter(i.children,{issueType:p.a.RelatedLink});if(s&&s.length>0&&s.forEach((function(t){t.children&&t.children.length>0&&(e.storyboardItem.relatedLinks=r.union(e.storyboardItem.relatedLinks,r.map(t.children,(function(t){return r.pick(t,e.fieldlist)}))))})),i.issueType===p.a.Epic){var n=r.find(i.children,{issueType:p.a.EpicChildren});n&&n.children&&n.children.length>0&&(e.storyboardItem.epicChildren=r.map(r.clone(n.children),(function(t){return r.pick(t,e.fieldlist)})),e.includeEpicChildren=!0)}else e.includeRelatedIssues=!0;e.plotIssuesOnStoryboard()}}))}},{key:"ngOnDestroy",value:function(){this.selectedItem$&&this.selectedItem$.unsubscribe()}},{key:"plotIssuesOnStoryboard",value:function(){this.storyboardItem.children=[],this.storyboardItem.metadata=Object(De.b)(),this.includeEpicChildren&&this.storyboardItem.epicChildren&&this.storyboardItem.epicChildren.length>0&&(this.epicChildrenIncluded=!0,this.storyboardItem.children=r.union(this.storyboardItem.children,this.storyboardItem.epicChildren),Object(De.c)(this.storyboardItem.metadata,Object(De.a)(this.storyboardItem.epicChildren))),this.includeRelatedIssues&&this.storyboardItem.relatedLinks&&this.storyboardItem.relatedLinks.length>0&&(this.storyboardItem.relatedLinksLoaded?(this.relatedIssuesIncluded=!0,this.storyboardItem.children=r.union(this.storyboardItem.children,this.storyboardItem.relatedLinks),Object(De.c)(this.storyboardItem.metadata,Object(De.a)(this.storyboardItem.relatedLinks))):this.populateRelatedLinks()),this.storyboardItem.statistics=Object(De.d)(this.storyboardItem)}},{key:"populateRelatedLinks",value:function(){var e=this,t=r.map(this.storyboardItem.relatedLinks,"key");t&&t.length>0&&this.jiraService.executeJql("key in (".concat(r.join(t,","),")"),0,100,["components","labels","fixVersions"],"linked-issues.json").subscribe((function(t){if(t&&t.issues){e.storyboardItem.relatedLinksLoaded=!0;var i=r.map(t.issues,(function(t){return r.pick(Object(p.m)(t),e.fieldlist)}));e.storyboardItem.relatedLinks.forEach((function(e){var t=r.find(i,{key:e.key});t&&(e.project=t.project,e.labels=t.labels,e.fixVersions=t.fixVersions,e.component=t.component)})),e.plotIssuesOnStoryboard()}}))}},{key:"onFieldValueChanged",value:function(e){this.store$.dispatch(new b(e))}}]),e}()).\u0275fac=function(e){return new(e||rt)(f.Qb(I.a),f.Qb(m.a),f.Qb(T.b),f.Qb(n.h))},rt.\u0275cmp=f.Kb({type:rt,selectors:[["app-storyboard"]],decls:1,vars:1,consts:[["class","pl-3 pr-3",4,"ngIf"],[1,"pl-3","pr-3"],[1,"row","small"],["class","col-md-3 mb-3",4,"ngIf"],["class","col-md-4 mb-3",4,"ngIf"],[1,"col-md-5","text-right"],[1,"btn","btn-link","float-right","mt-1",3,"click"],["size","lg",3,"icon"],[3,"storyboardItem","fieldValueChange"],["header","Statistics","position","right","class","bg-light",3,"visible","visibleChange",4,"ngIf"],[1,"col-md-3","mb-3"],[4,"ngIf"],["type","checkbox",3,"ngModel","ngModelChange","change"],[1,"badge","badge-success","ml-1"],[1,"col-md-4","mb-3"],["class","mr-4",4,"ngIf"],[1,"mr-4"],[1,"badge","badge-warning"],["header","Statistics","position","right",1,"bg-light",3,"visible","visibleChange"],[3,"statusStats","issueTypeStats","componentStats"]],template:function(e,t){1&e&&f.Ic(0,ct,9,6,"div",0),2&e&&f.pc("ngIf",t.storyboardItem)},directives:[s.l,v.a,He.a,x.a,x.f,x.i,qe.a,Je.a],encapsulation:2}),rt),ot=i("snw9"),ut=i("mrSG"),dt=i("eIep"),bt=i("JIr8"),pt=i("LRne"),ht=((at=function e(t,i,s){var n=this;_classCallCheck(this,e),this.actions$=t,this.store$=i,this.jiraService=s,this.updateFixVersions=this.actions$.pipe(Object(ot.d)(l.UpdateFieldValue),Object(dt.a)((function(e){return n.jiraService.updateFieldValue$(e.payload).pipe(Object(E.a)((function(){return{type:l.UpdateFieldValueSuccess,payload:e.payload}})),Object(bt.a)((function(){return Object(pt.a)({type:l.UpdateFieldValueFailed})})))})))}).\u0275fac=function(e){return new(e||at)(f.ec(ot.a),f.ec(n.h),f.ec(T.b))},at.\u0275prov=f.Mb({token:at,factory:at.\u0275fac}),Object(ut.b)([Object(ot.b)()],at.prototype,"updateFixVersions",void 0),at);i.d(t,"IssueModule",(function(){return mt}));var ft,gt=[{path:":selected",component:Q,children:[{path:"details",component:F},{path:"workbench",component:Xe},{path:"storyboard",component:lt},{path:"",redirectTo:"details",pathMatch:"full"}]}],mt=((ft=function e(){_classCallCheck(this,e)}).\u0275mod=f.Ob({type:ft}),ft.\u0275inj=f.Nb({factory:function(e){return new(e||ft)},imports:[[s.c,I.g,x.c,k.b,v.c,qe.b,S.b,U.g,U.c,U.n,X.a,O.a,n.j.forFeature("issue",h,{initialState:c}),ot.c.forFeature([ht]),I.g.forChild(gt)]]}),ft)}}]);